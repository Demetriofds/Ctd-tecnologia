!function(t,e,o){function a(t,e){return typeof t===e}function i(){var t,e,o,i,n,s,d;for(var m in l)if(l.hasOwnProperty(m)){if(t=[],e=l[m],e.name&&(t.push(e.name.toLowerCase()),e.options&&e.options.aliases&&e.options.aliases.length))for(o=0;o<e.options.aliases.length;o++)t.push(e.options.aliases[o].toLowerCase());for(i=a(e.fn,"function")?e.fn():e.fn,n=0;n<t.length;n++)s=t[n],d=s.split("."),1===d.length?c[d[0]]=i:(!c[d[0]]||c[d[0]]instanceof Boolean||(c[d[0]]=new Boolean(c[d[0]])),c[d[0]][d[1]]=i),r.push((i?"":"no-")+d.join("-"))}}function n(t){var e=u.className,o=c._config.classPrefix||"";if(p&&(e=e.baseVal),c._config.enableJSClass){var a=new RegExp("(^|\\s)"+o+"no-js(\\s|$)");e=e.replace(a,"$1"+o+"js$2")}c._config.enableClasses&&(e+=" "+o+t.join(" "+o),p?u.className.baseVal=e:u.className=e)}var r=[],l=[],s={_version:"3.3.1",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(t,e){var o=this;setTimeout(function(){e(o[t])},0)},addTest:function(t,e,o){l.push({name:t,fn:e,options:o})},addAsyncTest:function(t){l.push({name:null,fn:t})}},c=function(){};c.prototype=s,c=new c,c.addTest("cookies",function(){});var d=!1;try{d="WebSocket"in t&&2===t.WebSocket.CLOSING}catch(m){}c.addTest("websockets",d);var u=e.documentElement,p="svg"===u.nodeName.toLowerCase();c.addTest("localstorage",function(){var t="modernizr";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(e){return!1}}),i(),n(r),delete s.addTest,delete s.addAsyncTest;for(var h=0;h<c._q.length;h++)c._q[h]();t.AlobotModernizr=c}(window,document),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){for(var o=0,a=this.length;o<a;++o)t.call(e,this[o],o,this)}),function(t,e){e(t)}(this,function(t){var e=function(){function e(t){return null==t?String(t):G[Z.call(t)]||"object"}function o(t){return"function"==e(t)}function a(t){return null!=t&&t==t.window}function i(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function n(t){return"object"==e(t)}function r(t){return n(t)&&!a(t)&&Object.getPrototypeOf(t)==Object.prototype}function l(t){var e=!!t&&"length"in t&&t.length,o=T.type(t);return"function"!=o&&!a(t)&&("array"==o||0===e||"number"==typeof e&&e>0&&e-1 in t)}function s(t){return O.call(t,function(t){return null!=t})}function c(t){return t.length>0?T.fn.concat.apply([],t):t}function d(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function m(t){return t in $?$[t]:$[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function u(t,e){return"number"!=typeof e||L[d(t)]?e:e+"px"}function p(t){var e,o;return H[t]||(e=z.createElement(t),z.body.appendChild(e),o=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==o&&(o="block"),H[t]=o),H[t]}function h(t){return"children"in t?I.call(t.children):T.map(t.childNodes,function(t){if(1==t.nodeType)return t})}function f(t,e){var o,a=t?t.length:0;for(o=0;o<a;o++)this[o]=t[o];this.length=a,this.selector=e||""}function v(t,e,o){for(w in e)o&&(r(e[w])||tt(e[w]))?(r(e[w])&&!r(t[w])&&(t[w]={}),tt(e[w])&&!tt(t[w])&&(t[w]=[]),v(t[w],e[w],o)):e[w]!==x&&(t[w]=e[w])}function b(t,e){return null==e?T(t):T(t).filter(e)}function g(t,e,a,i){return o(e)?e.call(t,a,i):e}function _(t,e,o){null==o?t.removeAttribute(e):t.setAttribute(e,o)}function A(t,e){var o=t.className||"",a=o&&o.baseVal!==x;return e===x?a?o.baseVal:o:void(a?o.baseVal=e:t.className=e)}function y(t){try{return t?"true"==t||"false"!=t&&("null"==t?null:+t+""==t?+t:/^[\[\{]/.test(t)?T.parseJSON(t):t):t}catch(e){return t}}function C(t,e){e(t);for(var o=0,a=t.childNodes.length;o<a;o++)C(t.childNodes[o],e)}var x,w,T,k,E,M,D=[],S=D.concat,O=D.filter,I=D.slice,z=t.document,H={},$={},L={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},F=/^\s*<(\w+|!)[^>]*>/,P=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,j=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,N=/^(?:body|html)$/i,R=/([A-Z])/g,B=["val","css","html","text","data","width","height","offset"],J=["after","prepend","before","append"],q=z.createElement("table"),U=z.createElement("tr"),Q={tr:z.createElement("tbody"),tbody:q,thead:q,tfoot:q,td:U,th:U,"*":z.createElement("div")},V=/complete|loaded|interactive/,W=/^[\w-]*$/,G={},Z=G.toString,X={},Y=z.createElement("div"),K={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},tt=Array.isArray||function(t){return t instanceof Array};return X.matches=function(t,e){if(!e||!t||1!==t.nodeType)return!1;var o=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(o)return o.call(t,e);var a,i=t.parentNode,n=!i;return n&&(i=Y).appendChild(t),a=~X.qsa(i,e).indexOf(t),n&&Y.removeChild(t),a},E=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},M=function(t){return O.call(t,function(e,o){return t.indexOf(e)==o})},X.fragment=function(t,e,o){var a,i,n;return P.test(t)&&(a=T(z.createElement(RegExp.$1))),a||(t.replace&&(t=t.replace(j,"<$1></$2>")),e===x&&(e=F.test(t)&&RegExp.$1),e in Q||(e="*"),n=Q[e],n.innerHTML=""+t,a=T.each(I.call(n.childNodes),function(){n.removeChild(this)})),r(o)&&(i=T(a),T.each(o,function(t,e){B.indexOf(t)>-1?i[t](e):i.attr(t,e)})),a},X.Z=function(t,e){return new f(t,e)},X.isZ=function(t){return t instanceof X.Z},X.init=function(t,e){var a;if(!t)return X.Z();if("string"==typeof t)if(t=t.trim(),"<"==t[0]&&F.test(t))a=X.fragment(t,RegExp.$1,e),t=null;else{if(e!==x)return T(e).find(t);a=X.qsa(z,t)}else{if(o(t))return T(z).ready(t);if(X.isZ(t))return t;if(tt(t))a=s(t);else if(n(t))a=[t],t=null;else if(F.test(t))a=X.fragment(t.trim(),RegExp.$1,e),t=null;else{if(e!==x)return T(e).find(t);a=X.qsa(z,t)}}return X.Z(a,t)},T=function(t,e){return X.init(t,e)},T.extend=function(t){var e,o=I.call(arguments,1);return"boolean"==typeof t&&(e=t,t=o.shift()),o.forEach(function(o){v(t,o,e)}),t},X.qsa=function(t,e){var o,a="#"==e[0],i=!a&&"."==e[0],n=a||i?e.slice(1):e,r=W.test(n);return t.getElementById&&r&&a?(o=t.getElementById(n))?[o]:[]:1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType?[]:I.call(r&&!a&&t.getElementsByClassName?i?t.getElementsByClassName(n):t.getElementsByTagName(e):t.querySelectorAll(e))},T.contains=z.documentElement.contains?function(t,e){return t!==e&&t.contains(e)}:function(t,e){for(;e&&(e=e.parentNode);)if(e===t)return!0;return!1},T.type=e,T.isFunction=o,T.isWindow=a,T.isArray=tt,T.isPlainObject=r,T.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},T.isNumeric=function(t){var e=Number(t),o=typeof t;return null!=t&&"boolean"!=o&&("string"!=o||t.length)&&!isNaN(e)&&isFinite(e)||!1},T.inArray=function(t,e,o){return D.indexOf.call(e,t,o)},T.camelCase=E,T.trim=function(t){return null==t?"":String.prototype.trim.call(t)},T.uuid=0,T.support={},T.expr={},T.noop=function(){},T.map=function(t,e){var o,a,i,n=[];if(l(t))for(a=0;a<t.length;a++)o=e(t[a],a),null!=o&&n.push(o);else for(i in t)o=e(t[i],i),null!=o&&n.push(o);return c(n)},T.each=function(t,e){var o,a;if(l(t)){for(o=0;o<t.length;o++)if(e.call(t[o],o,t[o])===!1)return t}else for(a in t)if(e.call(t[a],a,t[a])===!1)return t;return t},T.grep=function(t,e){return O.call(t,e)},t.JSON&&(T.parseJSON=JSON.parse),T.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){G["[object "+e+"]"]=e.toLowerCase()}),T.fn={constructor:X.Z,length:0,forEach:D.forEach,reduce:D.reduce,push:D.push,sort:D.sort,splice:D.splice,indexOf:D.indexOf,concat:function(){var t,e,o=[];for(t=0;t<arguments.length;t++)e=arguments[t],o[t]=X.isZ(e)?e.toArray():e;return S.apply(X.isZ(this)?this.toArray():this,o)},map:function(t){return T(T.map(this,function(e,o){return t.call(e,o,e)}))},slice:function(){return T(I.apply(this,arguments))},ready:function(t){return V.test(z.readyState)&&z.body?t(T):z.addEventListener("DOMContentLoaded",function(){t(T)},!1),this},get:function(t){return t===x?I.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(t){var e={};try{this.forEach(function(o,a){if(t.call(o,a,o)===!1)throw e})}catch(o){if(o!=e)throw o}return this},filter:function(t){return o(t)?this.not(this.not(t)):T(O.call(this,function(e){return X.matches(e,t)}))},add:function(t,e){return T(M(this.concat(T(t,e))))},is:function(t){return this.length>0&&X.matches(this[0],t)},not:function(t){var e=[];if(o(t)&&t.call!==x)this.each(function(o){t.call(this,o)||e.push(this)});else{var a="string"==typeof t?this.filter(t):l(t)&&o(t.item)?I.call(t):T(t);this.forEach(function(t){a.indexOf(t)<0&&e.push(t)})}return T(e)},has:function(t){return this.filter(function(){return n(t)?T.contains(this,t):T(this).find(t).size()})},eq:function(t){return t===-1?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!n(t)?t:T(t)},last:function(){var t=this[this.length-1];return t&&!n(t)?t:T(t)},find:function(t){var e,o=this;return e=t?"object"==typeof t?T(t).filter(function(){var t=this;return D.some.call(o,function(e){return T.contains(e,t)})}):1==this.length?T(X.qsa(this[0],t)):this.map(function(){return X.qsa(this,t)}):T()},closest:function(t,e){var o=[],a="object"==typeof t&&T(t);return this.each(function(n,r){for(;r&&!(a?a.indexOf(r)>=0:X.matches(r,t));)r=r!==e&&!i(r)&&r.parentNode;r&&o.indexOf(r)<0&&o.push(r)}),T(o)},parents:function(t){for(var e=[],o=this;o.length>0;)o=T.map(o,function(t){if((t=t.parentNode)&&!i(t)&&e.indexOf(t)<0)return e.push(t),t});return b(e,t)},parent:function(t){return b(M(this.pluck("parentNode")),t)},children:function(t){return b(this.map(function(){return h(this)}),t)},contents:function(){return this.map(function(){return this.contentDocument||I.call(this.childNodes)})},siblings:function(t){return b(this.map(function(t,e){return O.call(h(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return T.map(this,function(e){return e[t]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=p(this.nodeName))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var e=o(t);if(this[0]&&!e)var a=T(t).get(0),i=a.parentNode||this.length>1;return this.each(function(o){T(this).wrapAll(e?t.call(this,o):i?a.cloneNode(!0):a)})},wrapAll:function(t){if(this[0]){T(this[0]).before(t=T(t));for(var e;(e=t.children()).length;)t=e.first();T(t).append(this)}return this},wrapInner:function(t){var e=o(t);return this.each(function(o){var a=T(this),i=a.contents(),n=e?t.call(this,o):t;i.length?i.wrapAll(n):a.append(n)})},unwrap:function(){return this.parent().each(function(){T(this).replaceWith(T(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=T(this);(t===x?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(t){return T(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return T(this.pluck("nextElementSibling")).filter(t||"*")},html:function(t){return 0 in arguments?this.each(function(e){var o=this.innerHTML;T(this).empty().append(g(this,t,e,o))}):0 in this?this[0].innerHTML:null},text:function(t){return 0 in arguments?this.each(function(e){var o=g(this,t,e,this.textContent);this.textContent=null==o?"":""+o}):0 in this?this.pluck("textContent").join(""):null},attr:function(t,e){var o;return"string"!=typeof t||1 in arguments?this.each(function(o){if(1===this.nodeType)if(n(t))for(w in t)_(this,w,t[w]);else _(this,t,g(this,e,o,this.getAttribute(t)))}):0 in this&&1==this[0].nodeType&&null!=(o=this[0].getAttribute(t))?o:x},removeAttr:function(t){return this.each(function(){1===this.nodeType&&t.split(" ").forEach(function(t){_(this,t)},this)})},prop:function(t,e){return t=K[t]||t,1 in arguments?this.each(function(o){this[t]=g(this,e,o,this[t])}):this[0]&&this[0][t]},removeProp:function(t){return t=K[t]||t,this.each(function(){delete this[t]})},data:function(t,e){var o="data-"+t.replace(R,"-$1").toLowerCase(),a=1 in arguments?this.attr(o,e):this.attr(o);return null!==a?y(a):x},val:function(t){return 0 in arguments?(null==t&&(t=""),this.each(function(e){this.value=g(this,t,e,this.value)})):this[0]&&(this[0].multiple?T(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(e){if(e)return this.each(function(t){var o=T(this),a=g(this,e,t,o.offset()),i=o.offsetParent().offset(),n={top:a.top-i.top,left:a.left-i.left};"static"==o.css("position")&&(n.position="relative"),o.css(n)});if(!this.length)return null;if(z.documentElement!==this[0]&&!T.contains(z.documentElement,this[0]))return{top:0,left:0};var o=this[0].getBoundingClientRect();return{left:o.left+t.pageXOffset,top:o.top+t.pageYOffset,width:Math.round(o.width),height:Math.round(o.height)}},css:function(t,o){if(arguments.length<2){var a=this[0];if("string"==typeof t){if(!a)return;return a.style[E(t)]||getComputedStyle(a,"").getPropertyValue(t)}if(tt(t)){if(!a)return;var i={},n=getComputedStyle(a,"");return T.each(t,function(t,e){i[e]=a.style[E(e)]||n.getPropertyValue(e)}),i}}var r="";if("string"==e(t))o||0===o?r=d(t)+":"+u(t,o):this.each(function(){this.style.removeProperty(d(t))});else for(w in t)t[w]||0===t[w]?r+=d(w)+":"+u(w,t[w])+";":this.each(function(){this.style.removeProperty(d(w))});return this.each(function(){this.style.cssText+=";"+r})},index:function(t){return t?this.indexOf(T(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return!!t&&D.some.call(this,function(t){return this.test(A(t))},m(t))},addClass:function(t){return t?this.each(function(e){if("className"in this){k=[];var o=A(this),a=g(this,t,e,o);a.split(/\s+/g).forEach(function(t){T(this).hasClass(t)||k.push(t)},this),k.length&&A(this,o+(o?" ":"")+k.join(" "))}}):this},removeClass:function(t){return this.each(function(e){if("className"in this){if(t===x)return A(this,"");k=A(this),g(this,t,e,k).split(/\s+/g).forEach(function(t){k=k.replace(m(t)," ")}),A(this,k.trim())}})},toggleClass:function(t,e){return t?this.each(function(o){var a=T(this),i=g(this,t,o,A(this));i.split(/\s+/g).forEach(function(t){(e===x?!a.hasClass(t):e)?a.addClass(t):a.removeClass(t)})}):this},scrollTop:function(t){if(this.length){var e="scrollTop"in this[0];return t===x?e?this[0].scrollTop:this[0].pageYOffset:this.each(e?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var e="scrollLeft"in this[0];return t===x?e?this[0].scrollLeft:this[0].pageXOffset:this.each(e?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),o=this.offset(),a=N.test(e[0].nodeName)?{top:0,left:0}:e.offset();return o.top-=parseFloat(T(t).css("margin-top"))||0,o.left-=parseFloat(T(t).css("margin-left"))||0,a.top+=parseFloat(T(e[0]).css("border-top-width"))||0,a.left+=parseFloat(T(e[0]).css("border-left-width"))||0,{top:o.top-a.top,left:o.left-a.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||z.body;t&&!N.test(t.nodeName)&&"static"==T(t).css("position");)t=t.offsetParent;return t})}},T.fn.detach=T.fn.remove,["width","height"].forEach(function(t){var e=t.replace(/./,function(t){return t[0].toUpperCase()});T.fn[t]=function(o){var n,r=this[0];return o===x?a(r)?r["inner"+e]:i(r)?r.documentElement["scroll"+e]:(n=this.offset())&&n[t]:this.each(function(e){r=T(this),r.css(t,g(this,o,e,r[t]()))})}}),J.forEach(function(o,a){var i=a%2;T.fn[o]=function(){var o,n,r=T.map(arguments,function(t){var a=[];return o=e(t),"array"==o?(t.forEach(function(t){return t.nodeType!==x?a.push(t):T.zepto.isZ(t)?a=a.concat(t.get()):void(a=a.concat(X.fragment(t)))}),a):"object"==o||null==t?t:X.fragment(t)}),l=this.length>1;return r.length<1?this:this.each(function(e,o){n=i?o:o.parentNode,o=0==a?o.nextSibling:1==a?o.firstChild:2==a?o:null;var s=T.contains(z.documentElement,n);r.forEach(function(e){if(l)e=e.cloneNode(!0);else if(!n)return T(e).remove();n.insertBefore(e,o),s&&C(e,function(e){if(!(null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src)){var o=e.ownerDocument?e.ownerDocument.defaultView:t;o.eval.call(o,e.innerHTML)}})})})},T.fn[i?o+"To":"insert"+(a?"Before":"After")]=function(t){return T(t)[o](this),this}}),X.Z.prototype=f.prototype=T.fn,X.uniq=M,X.deserializeValue=y,T.zepto=X,T}();return t.AlobotJQuery=e,function(e){function o(t){return t._zid||(t._zid=p++)}function a(t,e,a,r){if(e=i(e),e.ns)var l=n(e.ns);return(b[o(t)]||[]).filter(function(t){return t&&(!e.e||t.e==e.e)&&(!e.ns||l.test(t.ns))&&(!a||o(t.fn)===o(a))&&(!r||t.sel==r)})}function i(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function n(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function r(t,e){return t.del&&!_&&t.e in A||!!e}function l(t){return y[t]||_&&A[t]||t}function s(t,a,n,s,c,m,p){var h=o(t),f=b[h]||(b[h]=[]);a.split(/\s/).forEach(function(o){if("ready"==o)return e(document).ready(n);var a=i(o);a.fn=n,a.sel=c,a.e in y&&(n=function(t){var o=t.relatedTarget;if(!o||o!==this&&!e.contains(this,o))return a.fn.apply(this,arguments)}),a.del=m;var h=m||n;a.proxy=function(e){if(e=d(e),!e.isImmediatePropagationStopped()){e.data=s;var o=h.apply(t,e._args==u?[e]:[e].concat(e._args));return o===!1&&(e.preventDefault(),e.stopPropagation()),o}},a.i=f.length,f.push(a),"addEventListener"in t&&t.addEventListener(l(a.e),a.proxy,r(a,p))})}function c(t,e,i,n,s){var c=o(t);(e||"").split(/\s/).forEach(function(e){a(t,e,i,n).forEach(function(e){delete b[c][e.i],"removeEventListener"in t&&t.removeEventListener(l(e.e),e.proxy,r(e,s))})})}function d(t,o){return!o&&t.isDefaultPrevented||(o||(o=t),e.each(T,function(e,a){var i=o[e];t[e]=function(){return this[a]=C,i&&i.apply(o,arguments)},t[a]=x}),t.timeStamp||(t.timeStamp=Date.now()),(o.defaultPrevented!==u?o.defaultPrevented:"returnValue"in o?o.returnValue===!1:o.getPreventDefault&&o.getPreventDefault())&&(t.isDefaultPrevented=C)),t}function m(t){var e,o={originalEvent:t};for(e in t)w.test(e)||t[e]===u||(o[e]=t[e]);return d(o,t)}var u,p=1,h=Array.prototype.slice,f=e.isFunction,v=function(t){return"string"==typeof t},b={},g={},_="onfocusin"in t,A={focus:"focusin",blur:"focusout"},y={mouseenter:"mouseover",mouseleave:"mouseout"};g.click=g.mousedown=g.mouseup=g.mousemove="MouseEvents",e.event={add:s,remove:c},e.proxy=function(t,a){var i=2 in arguments&&h.call(arguments,2);if(f(t)){var n=function(){return t.apply(a,i?i.concat(h.call(arguments)):arguments)};return n._zid=o(t),n}if(v(a))return i?(i.unshift(t[a],t),e.proxy.apply(null,i)):e.proxy(t[a],t);throw new TypeError("expected function")},e.fn.bind=function(t,e,o){return this.on(t,e,o)},e.fn.unbind=function(t,e){return this.off(t,e)},e.fn.one=function(t,e,o,a){return this.on(t,e,o,a,1)};var C=function(){return!0},x=function(){return!1},w=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,T={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};e.fn.delegate=function(t,e,o){return this.on(e,t,o)},e.fn.undelegate=function(t,e,o){return this.off(e,t,o)},e.fn.live=function(t,o){return e(document.body).delegate(this.selector,t,o),this},e.fn.die=function(t,o){return e(document.body).undelegate(this.selector,t,o),this},e.fn.on=function(t,o,a,i,n){var r,l,d=this;return t&&!v(t)?(e.each(t,function(t,e){d.on(t,o,a,e,n)}),d):(v(o)||f(i)||i===!1||(i=a,a=o,o=u),i!==u&&a!==!1||(i=a,a=u),i===!1&&(i=x),d.each(function(d,u){n&&(r=function(t){return c(u,t.type,i),i.apply(this,arguments)}),o&&(l=function(t){var a,n=e(t.target).closest(o,u).get(0);if(n&&n!==u)return a=e.extend(m(t),{currentTarget:n,liveFired:u}),(r||i).apply(n,[a].concat(h.call(arguments,1)))}),s(u,t,i,a,o,l||r)}))},e.fn.off=function(t,o,a){var i=this;return t&&!v(t)?(e.each(t,function(t,e){i.off(t,o,e)}),i):(v(o)||f(a)||a===!1||(a=o,o=u),a===!1&&(a=x),i.each(function(){c(this,t,a,o)}))},e.fn.trigger=function(t,o){return t=v(t)||e.isPlainObject(t)?e.Event(t):d(t),t._args=o,this.each(function(){t.type in A&&"function"==typeof this[t.type]?this[t.type]():"dispatchEvent"in this?this.dispatchEvent(t):e(this).triggerHandler(t,o)})},e.fn.triggerHandler=function(t,o){var i,n;return this.each(function(r,l){i=m(v(t)?e.Event(t):t),i._args=o,i.target=l,e.each(a(l,t.type||t),function(t,e){if(n=e.proxy(i),i.isImmediatePropagationStopped())return!1})}),n},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(t){e.fn[t]=function(e){return 0 in arguments?this.bind(t,e):this.trigger(t)}}),e.Event=function(t,e){v(t)||(e=t,t=e.type);var o=document.createEvent(g[t]||"Events"),a=!0;if(e)for(var i in e)"bubbles"==i?a=!!e[i]:o[i]=e[i];return o.initEvent(t,a,!0),d(o)}}(e),function(e){function o(t,o,a){var i=e.Event(o);return e(t).trigger(i,a),!i.isDefaultPrevented()}function a(t,e,a,i){if(t.global)return o(e||A,a,i)}function i(t){t.global&&0===e.active++&&a(t,null,"ajaxStart")}function n(t){t.global&&!--e.active&&a(t,null,"ajaxStop")}function r(t,e){var o=e.context;return e.beforeSend.call(o,t,e)!==!1&&a(e,o,"ajaxBeforeSend",[t,e])!==!1&&void a(e,o,"ajaxSend",[t,e])}function l(t,e,o,i){var n=o.context,r="success";o.success.call(n,t,r,e),i&&i.resolveWith(n,[t,r,e]),a(o,n,"ajaxSuccess",[e,o,t]),c(r,e,o)}function s(t,e,o,i,n){var r=i.context;i.error.call(r,o,e,t),n&&n.rejectWith(r,[o,e,t]),a(i,r,"ajaxError",[o,i,t||e]),c(e,o,i)}function c(t,e,o){var i=o.context;o.complete.call(i,e,t),a(o,i,"ajaxComplete",[e,o]),n(o)}function d(t,e,o){if(o.dataFilter==m)return t;var a=o.context;return o.dataFilter.call(a,t,e)}function m(){}function u(t){return t&&(t=t.split(";",2)[0]),t&&(t==T?"html":t==w?"json":C.test(t)?"script":x.test(t)&&"xml")||"text"}function p(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function h(t){t.processData&&t.data&&"string"!=e.type(t.data)&&(t.data=e.param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()&&"jsonp"!=t.dataType||(t.url=p(t.url,t.data),t.data=void 0)}function f(t,o,a,i){return e.isFunction(o)&&(i=a,a=o,o=void 0),e.isFunction(a)||(i=a,a=void 0),{url:t,data:o,success:a,dataType:i}}function v(t,o,a,i){var n,r=e.isArray(o),l=e.isPlainObject(o);e.each(o,function(o,s){n=e.type(s),i&&(o=a?i:i+"["+(l||"object"==n||"array"==n?o:"")+"]"),!i&&r?t.add(s.name,s.value):"array"==n||!a&&"object"==n?v(t,s,a,o):t.add(o,s)})}var b,g,_=+new Date,A=t.document,y=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,C=/^(?:text|application)\/javascript/i,x=/^(?:text|application)\/xml/i,w="application/json",T="text/html",k=/^\s*$/,E=A.createElement("a");E.href=t.location.href,e.active=0,e.ajaxJSONP=function(o,a){if(!("type"in o))return e.ajax(o);var i,n,c=o.jsonpCallback,d=(e.isFunction(c)?c():c)||"Zepto"+_++,m=A.createElement("script"),u=t[d],p=function(t){e(m).triggerHandler("error",t||"abort")},h={abort:p};return a&&a.promise(h),e(m).on("load error",function(r,c){clearTimeout(n),e(m).off().remove(),"error"!=r.type&&i?l(i[0],h,o,a):s(null,c||"error",h,o,a),t[d]=u,i&&e.isFunction(u)&&u(i[0]),u=i=void 0}),r(h,o)===!1?(p("abort"),h):(t[d]=function(){i=arguments},m.src=o.url.replace(/\?(.+)=\?/,"?$1="+d),A.head.appendChild(m),o.timeout>0&&(n=setTimeout(function(){p("timeout")},o.timeout)),h)},e.ajaxSettings={type:"GET",beforeSend:m,success:m,error:m,complete:m,context:null,global:!0,xhr:function(){return new t.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:w,xml:"application/xml, text/xml",html:T,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0,dataFilter:m},e.ajax=function(o){var a,n,c=e.extend({},o||{}),f=e.Deferred&&e.Deferred();for(b in e.ajaxSettings)void 0===c[b]&&(c[b]=e.ajaxSettings[b]);i(c),c.crossDomain||(a=A.createElement("a"),a.href=c.url,a.href=a.href,c.crossDomain=E.protocol+"//"+E.host!=a.protocol+"//"+a.host),c.url||(c.url=t.location.toString()),(n=c.url.indexOf("#"))>-1&&(c.url=c.url.slice(0,n)),h(c);var v=c.dataType,_=/\?.+=\?/.test(c.url);if(_&&(v="jsonp"),c.cache!==!1&&(o&&o.cache===!0||"script"!=v&&"jsonp"!=v)||(c.url=p(c.url,"_="+Date.now())),"jsonp"==v)return _||(c.url=p(c.url,c.jsonp?c.jsonp+"=?":c.jsonp===!1?"":"callback=?")),e.ajaxJSONP(c,f);var y,C=c.accepts[v],x={},w=function(t,e){x[t.toLowerCase()]=[t,e]},T=/^([\w-]+:)\/\//.test(c.url)?RegExp.$1:t.location.protocol,M=c.xhr(),D=M.setRequestHeader;if(f&&f.promise(M),c.crossDomain||w("X-Requested-With","XMLHttpRequest"),w("Accept",C||"*/*"),(C=c.mimeType||C)&&(C.indexOf(",")>-1&&(C=C.split(",",2)[0]),M.overrideMimeType&&M.overrideMimeType(C)),(c.contentType||c.contentType!==!1&&c.data&&"GET"!=c.type.toUpperCase())&&w("Content-Type",c.contentType||"application/x-www-form-urlencoded"),c.headers)for(g in c.headers)w(g,c.headers[g]);if(M.setRequestHeader=w,M.onreadystatechange=function(){if(4==M.readyState){M.onreadystatechange=m,clearTimeout(y);var t,o=!1;if(M.status>=200&&M.status<300||304==M.status||0==M.status&&"file:"==T){if(v=v||u(c.mimeType||M.getResponseHeader("content-type")),"arraybuffer"==M.responseType||"blob"==M.responseType)t=M.response;else{t=M.responseText;try{t=d(t,v,c),"script"==v?(0,eval)(t):"xml"==v?t=M.responseXML:"json"==v&&(t=k.test(t)?null:e.parseJSON(t))}catch(a){o=a}if(o)return s(o,"parsererror",M,c,f)}l(t,M,c,f)}else s(M.statusText||null,M.status?"error":"abort",M,c,f)}},r(M,c)===!1)return M.abort(),s(null,"abort",M,c,f),M;var S=!("async"in c)||c.async;if(M.open(c.type,c.url,S,c.username,c.password),c.xhrFields)for(g in c.xhrFields)M[g]=c.xhrFields[g];for(g in x)D.apply(M,x[g]);return c.timeout>0&&(y=setTimeout(function(){M.onreadystatechange=m,M.abort(),s(null,"timeout",M,c,f)},c.timeout)),M.send(c.data?c.data:null),M},e.get=function(){return e.ajax(f.apply(null,arguments))},e.post=function(){var t=f.apply(null,arguments);return t.type="POST",e.ajax(t)},e.getJSON=function(){var t=f.apply(null,arguments);return t.dataType="json",e.ajax(t)},e.fn.load=function(t,o,a){if(!this.length)return this;var i,n=this,r=t.split(/\s/),l=f(t,o,a),s=l.success;return r.length>1&&(l.url=r[0],i=r[1]),l.success=function(t){n.html(i?e("<div>").html(t.replace(y,"")).find(i):t),s&&s.apply(n,arguments)},e.ajax(l),this};var M=encodeURIComponent;e.param=function(t,o){var a=[];return a.add=function(t,o){e.isFunction(o)&&(o=o()),null==o&&(o=""),this.push(M(t)+"="+M(o))},v(a,t,o),a.join("&").replace(/%20/g,"+")}}(e),function(t){t.fn.serializeArray=function(){var e,o,a=[],i=function(t){return t.forEach?t.forEach(i):void a.push({name:e,value:t})};return this[0]&&t.each(this[0].elements,function(a,n){o=n.type,e=n.name,e&&"fieldset"!=n.nodeName.toLowerCase()&&!n.disabled&&"submit"!=o&&"reset"!=o&&"button"!=o&&"file"!=o&&("radio"!=o&&"checkbox"!=o||n.checked)&&i(t(n).val())}),a},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(0 in arguments)this.bind("submit",e);else if(this.length){var o=t.Event("submit");this.eq(0).trigger(o),o.isDefaultPrevented()||this.get(0).submit()}return this}}(e),function(){try{getComputedStyle(void 0)}catch(e){var o=getComputedStyle;t.getComputedStyle=function(t,e){try{return o(t,e)}catch(a){return null}}}}(),e}),function(t){window.AlobotCookies=t()}(function(){function t(){for(var t=0,e={};t<arguments.length;t++){var o=arguments[t];for(var a in o)e[a]=o[a]}return e}function e(o){function a(e,i,n){var r;if("undefined"!=typeof document){if(arguments.length>1){if(n=t({path:"/"},a.defaults,n),"number"==typeof n.expires){var l=new Date;l.setMilliseconds(n.expires),n.expires=l}try{r=JSON.stringify(i),/^[\{\[]/.test(r)&&(i=r)}catch(s){}return i=o.write?o.write(i,e):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)),e=e.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),e=e.replace(/[\(\)]/g,escape),document.cookie=[e,"=",i,n.expires&&"; expires="+n.expires.toUTCString(),n.path&&"; path="+n.path,n.domain&&"; domain="+n.domain,n.sameSite&&"; SameSite="+n.sameSite,n.secure?"; secure":""].join("")}e||(r={});for(var c=document.cookie?document.cookie.split("; "):[],d=/(%[0-9A-Z]{2})+/g,m=0;m<c.length;m++){var u=c[m].split("="),p=u.slice(1).join("=");'"'===p.charAt(0)&&(p=p.slice(1,-1));try{var h=u[0].replace(d,decodeURIComponent);if(p=o.read?o.read(p,h):o(p,h)||p.replace(d,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(s){}if(e===h){r=p;break}e||(r[h]=p)}catch(s){}}return r}}return a.set=a,a.get=function(t){return a(t)},a.getJSON=function(){return a.apply({json:!0},[].slice.call(arguments))},a.defaults={},a.remove=function(e,o){a(e,"",t(o,{expires:-1}))},a.withConverter=e,a}return e(function(){})}),function(){var t={},e=null,o=null,a=null,i=null,n={},r=Math.ceil(window.devicePixelRatio)||1,l=16*r,s={width:7,height:9,font:10*r+"px arial",color:"#ffffff",background:"#F03D25",fallback:!0,crossOrigin:!0,abbreviate:!0},c=function(){var t=navigator.userAgent.toLowerCase();return function(e){return t.indexOf(e)!==-1}}(),d={ie:c("trident"),chrome:c("chrome"),webkit:c("chrome")||c("safari"),safari:c("safari")&&!c("chrome"),mozilla:c("mozilla")&&!c("chrome")&&!c("safari")},m=function(){for(var t=document.getElementsByTagName("link"),e=0,o=t.length;e<o;e++)if((t[e].getAttribute("rel")||"").match(/\bicon\b/i))return t[e];return!1},u=function(){for(var t=document.getElementsByTagName("link"),e=document.getElementsByTagName("head")[0],o=0,a=t.length;o<a;o++){var i="undefined"!=typeof t[o];i&&(t[o].getAttribute("rel")||"").match(/\bicon\b/i)&&e.removeChild(t[o])}},p=function(){if(!o||!e){var t=m();e=t?t.getAttribute("href"):"/favicon.ico",o||(o=e)}return e},h=function(){return i||(i=document.createElement("canvas"),i.width=l,i.height=l),i},f=function(t){if(t){u();var e=document.createElement("link");e.type="image/x-icon",e.rel="icon",e.href=t,document.getElementsByTagName("head")[0].appendChild(e)}},v=function(t,e){if(!h().getContext||d.ie||d.safari||"force"===n.fallback)return b(t);var o=h().getContext("2d"),e=e||"#000000",i=p();a=document.createElement("img"),a.onload=function(){o.clearRect(0,0,l,l),o.drawImage(a,0,0,a.width,a.height,0,0,l,l),(t+"").length>0&&g(o,t,e),_()},!i.match(/^data/)&&n.crossOrigin&&(a.crossOrigin="anonymous"),a.src=i},b=function(t){if(n.fallback){var e=document.title;"("===e[0]&&(e=e.slice(e.indexOf(" "))),(t+"").length>0?document.title="("+t+") "+e:document.title=e}},g=function(t,e,o){"number"==typeof e&&e>99&&n.abbreviate&&(e=A(e));var a=(e+"").length-1,i=n.width*r+6*r*a,s=n.height*r,c=l-s,m=l-i-r,u=16*r,p=16*r,h=2*r;t.font=(d.webkit?"bold ":"")+n.font,t.fillStyle=n.background,t.strokeStyle=n.background,t.lineWidth=r,t.beginPath(),t.moveTo(m+h,c),t.quadraticCurveTo(m,c,m,c+h),t.lineTo(m,u-h),t.quadraticCurveTo(m,u,m+h,u),t.lineTo(p-h,u),t.quadraticCurveTo(p,u,p,u-h),t.lineTo(p,c+h),t.quadraticCurveTo(p,c,p-h,c),t.closePath(),t.fill(),t.beginPath(),t.strokeStyle="rgba(0,0,0,0.3)",t.moveTo(m+h/2,u),t.lineTo(p-h/2,u),t.stroke(),t.fillStyle=n.color,t.textAlign="right",t.textBaseline="top",t.fillText(e,2===r?29:15,d.mozilla?7*r:6*r)},_=function(){h().getContext&&f(h().toDataURL())},A=function(t){for(var e=[["G",1e9],["M",1e6],["k",1e3]],o=0;o<e.length;++o)if(t>=e[o][1]){t=y(t/e[o][1])+e[o][0];
break}return t},y=function(t,e){var o=new Number(t);return o.toFixed(e)};t.setOptions=function(t){n={},t.colour&&(t.color=t.colour);for(var e in s)n[e]=t.hasOwnProperty(e)?t[e]:s[e];return this},t.setImage=function(t){return e=t,_(),this},t.setBubble=function(t,e){return t=t||"",v(t,e),this},t.reset=function(){e=o,f(o)},t.setOptions(s),window.AlobotTinycon=t}(),function(t){var e=function(t,e){return t.indexOf(e)},o=t.AlobotEventEmitter=function(){this.events={}};o.prototype.on=function(t,e){"object"!=typeof this.events[t]&&(this.events[t]=[]),this.events[t].push(e)},o.prototype.removeListener=function(t,o){var a;"object"==typeof this.events[t]&&(a=e(this.events[t],o),a>-1&&this.events[t].splice(a,1))},o.prototype.emit=function(t){var e,o,a,i=[].slice.call(arguments,1);if("object"==typeof this.events[t])for(o=this.events[t].slice(),a=o.length,e=0;e<a;e++)o[e].apply(this,i)},o.prototype.once=function(t,e){this.on(t,function o(){this.removeListener(t,o),e.apply(this,arguments)})}}(window),window.inicializarThumbnail=function(t,e){e(t).css("display","inline-block"),e(t).css("vertical-align","top"),e(t).css("margin-right","5px");var o=t.href,a=o.split("/"),i=a[a.length-1],n=i.split("?")[0],r=n.split(".")[1],l=n.replace(/^\d+\_/,"");l=l.replace("."+r,"");var s=o.indexOf(".png")!==-1||o.indexOf(".jpg")!==-1||o.indexOf(".jpeg")!==-1||o.indexOf(".gif")!==-1;s?(t.innerHTML='<div style="display: inline-flex;"><div style="width: 80px; height: 60px; background: #5A67D8; color: #fff; font-weight: bold; font-size: 16px; display: flex; align-items: center; justify-content: center; border-top-left-radius: 3px; border-bottom-left-radius: 3px;">'+(r?r.toUpperCase():"FILE")+'</div><div style="border-top: 1px solid #E2E8F0; border-right: 1px solid #E2E8F0; border-bottom: 1px solid #E2E8F0; width: 200px; background: #fff; height: 60px; box-sizing: border-box; padding: 5px; color: #000; display: flex; align-items: center; justify-content: center; word-break: break-all; border-top-right-radius: 3px; border-bottom-right-radius: 3px; overflow: hidden;">Carregando...</div></div>',e.ajax({type:"get",url:urlPrefix+"/arquivo_thumbnail?url="+o,success:function(e){t.innerHTML='<div style="display: inline-flex;"><img src="'+e+'" style="width: 80px; height: 60px; border-top-left-radius: 3px; border-bottom-left-radius: 3px;"><div style="border-top: 1px solid #E2E8F0; border-right: 1px solid #E2E8F0; border-bottom: 1px solid #E2E8F0; width: 200px; background: #fff; height: 60px; box-sizing: border-box; padding: 5px; color: #000; display: flex; align-items: center; justify-content: center; word-break: break-all; border-top-right-radius: 3px; border-bottom-right-radius: 3px; overflow: hidden;">'+l+"</div></div>"},error:function(){t.innerHTML='<div style="display: inline-flex;"><div style="width: 80px; height: 60px; background: #5A67D8; color: #fff; font-weight: bold; font-size: 16px; display: flex; align-items: center; justify-content: center; border-top-left-radius: 3px; border-bottom-left-radius: 3px;">'+(r?r.toUpperCase():"FILE")+'</div><div style="border-top: 1px solid #E2E8F0; border-right: 1px solid #E2E8F0; border-bottom: 1px solid #E2E8F0; width: 200px; background: #fff; height: 60px; box-sizing: border-box; padding: 5px; color: #000; display: flex; align-items: center; justify-content: center; word-break: break-all; border-top-right-radius: 3px; border-bottom-right-radius: 3px; overflow: hidden;">'+l+"</div></div>"}})):t.innerHTML='<div style="display: inline-flex;"><div style="width: 80px; height: 60px; background: #5A67D8; color: #fff; font-weight: bold; font-size: 16px; display: flex; align-items: center; justify-content: center; border-top-left-radius: 3px; border-bottom-left-radius: 3px;">'+(r?r.toUpperCase():"FILE")+'</div><div style="border-top: 1px solid #E2E8F0; border-right: 1px solid #E2E8F0; border-bottom: 1px solid #E2E8F0; width: 200px; background: #fff; height: 60px; box-sizing: border-box; padding: 5px; color: #000; display: flex; align-items: center; justify-content: center; word-break: break-all; border-top-right-radius: 3px; border-bottom-right-radius: 3px; overflow: hidden;">'+l+"</div></div>"},window.b64EncodeUnicode=function(t){return btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,function(t,e){return String.fromCharCode(parseInt(e,16))}))},window.b64DecodeUnicode=function(t){return decodeURIComponent(Array.prototype.map.call(atob(t),function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""))},function(){function t(t){return t.indexOf("v4.aloweb")>=0&&(t=t.replace("v4.aloweb","static.aloweb")),t}function e(t){for(var e=t.split(/(https?:\/\/)/),o=[],a=0;a<e.length;a++)e[a].indexOf("http")!==-1?o.push(e[a]):o.push(e[a].replace(/\/\//,"/"));return o.join("")}function o(e){var o=document.createElement("link");o.rel="stylesheet",i()?(l.config.mobile=!0,o.href=t(l.url)+"/css/alobot-mobile-min.css"):l.config&&l.config.fullscreen?o.href=t(l.url)+"/css/alobot-standalone-min.css":o.href=t(l.url)+"/css/alobot-min.css",o.onload=function(){e()},document.body.appendChild(o)}function a(o,a){AlobotJQuery.get(e(t(l.url)+o),function(t){a(t)})}function i(){var t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}function n(t){t=t||{};var e="alobot-wrapper";t.fullscreen&&(e+=" alobot-fullscreen"),t.mobile_fullscreen===!1&&(e+=" alobot-nao-fullscreen-para-mobile");var o=AlobotJQuery('<div class="'+e+'"><div class="alobot-container"></div></div>'),a=o.find(".alobot-container");AlobotJQuery(document.body).append(o),l.$wrapper=o,l.$container=a}function r(){l.start=c.start,l.showTriggerMessage=c.showTriggerMessage}var l=this.AlobotClient=new AlobotEventEmitter;l.url=window.urlPrefix,l.socketUrl=window.rtsUrl,l.socketPath=window.socketPath,l.verificacaoStatusInterval=1e4,l.atualizarIntervaloDeVerificacaoDeAcordoComPosicaoNaFila=function(t){t<20?l.verificacaoStatusInterval=1e4:t<50?l.verificacaoStatusInterval=3e4:t<100?l.verificacaoStatusInterval=6e4:t>100&&(l.verificacaoStatusInterval=3e5)},l.corrigirUrl=e,l.normalizarUrl=t,l.carregarConfiguracao=a,l.stripHTML=function(t){return t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/(?:\r\n|\r|\n)/g," <br />")},l.adicionarHiperlinks=function(t){for(var e=/(http:\/\/|https:\/\/|www\.)[^\s\r\n]+/g,o=null,a=t;o=e.exec(t);){var i=o[0],n=o[0];i.length>28&&(n=i.substring(0,28)+"..."),a=a.replace(i,'<a class="alobot-link" href="'+i+'" target="_blank">'+n+"</a>")}return a},l.respeitarFilaTransferencia=function(){var t=l.opts.respeitar_fila_transferencia;return void 0===t||1==t},l.isTransparente=function(t){return"rgba(255, 255, 255, 0)"==t},l.escurecerCor=function(t,e){if(!t)return"#DFDFDF";var o=parseInt(t.substring(1,3),16),a=parseInt(t.substring(3,5),16),i=parseInt(t.substring(5,7),16);o=parseInt(o*(100+e)/100),a=parseInt(a*(100+e)/100),i=parseInt(i*(100+e)/100),o=o<255?o:255,a=a<255?a:255,i=i<255?i:255;var n=1==o.toString(16).length?"0"+o.toString(16):o.toString(16),r=1==a.toString(16).length?"0"+a.toString(16):a.toString(16),l=1==i.toString(16).length?"0"+i.toString(16):i.toString(16);return"#"+n+r+l},l.timestamp=function(){return(new Date).getTime()};var s={nome:["nome","name"],email:["email"],mensagem:["message","mensagem","first_message"],id_departamento:["id_departamento","department_id"],linguagem:["linguagem","language"]};l.getConfig=function(t){if(l.config){if(s[t])for(var e=s[t],o=0;o<e.length;o++){var a=e[o];if(l.config[a])return l.config[a]}return l.config[t]}},l.chatViewClass=function(){var t=l.opts.chat||{},e=t.layoutSemIdentificacaoIdDepartamento;e||(e=l.Trigger.atendimentoDiretoIdDepartamento,e&&(t.layoutSemIdentificacaoIdDepartamento=e));var o=l.Trigger.abrirAtendimentoDireto,a=o||t&&"sem_identificacao"==t.layoutOnline;return a&&e?l.ChatDirectView:l.ChatDefaultView},l.contemTodosParametrosParaIniciarAtendimento=function(){return l.getConfig("name")&&l.getConfig("email")&&l.getConfig("id_departamento")&&l.getConfig("first_message")},l.garantirSocketIOCarregado=function(e){if(window.AlobotIO)return e();var o=document.createElement("script");o.type="text/javascript",o.src=t(l.url)+"/js/socket.io-2.2.0.js",o.onload=function(){e()},document.body.appendChild(o)},l.iniciarAtendimentoComParametrosInternos=function(){l.mostrarIdentificacaoChat(function(){l.chat.view.tentarIniciarAtendimento()})},l.linguagemDoCliente=function(){if(l.getConfig("linguagem")){var t=l.getConfig("linguagem");return t=t.toLowerCase().replace("-","_")}var e=l.opts?l.opts.config:{},t=navigator.language||navigator.userLanguage||e.linguagem||"pt_br";return t=t.toLowerCase().replace("-","_")},l.configurar=function(t,e){this.url=t.url,this.rtsUrl=t.rtsUrl,this.socketPath=t.socketPrefix,this.config=t,this.argConfig=e},l.suportaUploadDeArquivos=function(){return!!window.FormData},l.imagemAvaliacao=function(t){var e=l.url;return e+"/img/alobot/avaliacao_"+t+".png"},l.tokenOuIdFilial=function(){return l.tokenFilial?l.tokenFilial:l.idFilial},l.identificarTokenPersonalizacao=function(t){l.tokenPersonalizacao=t.replace("/storage/alobot_personalizacao-","").replace(".json","")};var c={start:function(){return l.minimizado?(l.restaurar(),!0):(console.log({estaAberto:l.estaAberto()}),!l.estaAberto()&&(l.mostrarIdentificacaoChat(),!0))},showTriggerMessage:function(t){var e={cor_mensagem_gatilho:t.background||"",mensagem_avatar:t.avatar||""};t.url&&(e.acao_click="abrir_link",e.abrir_link_url=t.url);var o={mensagem:t.message||""};l.Trigger.renderAviso(e,o)}};l.inicializar=function(t,e){if(l.parametroInicial=t,AlobotModernizr.websockets){var i=this;"string"==typeof t?(this.identificarTokenPersonalizacao(t),a(t,function(t){i.opts=t,i.idFilial=t.id_filial,i.tokenFilial=t.token_filial,o(function(){n(i.config),l.Configuracao.inicializar(function(){l.I18n.inicializar(function(){r(),l.emit("ready"),e(),l.Trigger.inicializar()})})})})):(this.opts=t,this.idFilial=t.id_filial,o(function(){n(i.config),e()}))}},l.extrairArquivoDaUrl=function(t){var e=t.split(/\//),o=e[e.length-1];return o=o.replace(/^[\d]+_/,"")},l.loadingGifUrl=function(){return l.url+"/img/loading.GIF"},l.estaEmAtendimento=function(t){return null==t?null!=l.cache("id_atendimento"):null==l.cache("id_atendimento")?t(!1):void l.Atendimento.status(l.cache("id_atendimento"),function(e){t("encerrado"!=e.status)},{primeiraVisita:!0})},l.navegadorAtual=function(){var t=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,e="undefined"!=typeof InstallTrigger,o=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,a=!!window.chrome&&!t,i=!!document.documentMode,n=!i&&!!window.StyleMedia;return t?"Opera":e?"Firefox":o?"Safari":a?"Chrome":i?"IE":n?"Edge":"Don't know"},l.sistemaOperacionalAtual=function(){var t="Unknown";return window.navigator.userAgent.indexOf("Windows NT 6.2")!=-1&&(t="Windows 8"),window.navigator.userAgent.indexOf("Windows NT 6.1")!=-1&&(t="Windows 7"),window.navigator.userAgent.indexOf("Windows NT 6.0")!=-1&&(t="Windows Vista"),window.navigator.userAgent.indexOf("Windows NT 5.1")!=-1&&(t="Windows XP"),window.navigator.userAgent.indexOf("Windows NT 5.0")!=-1&&(t="Windows 2000"),window.navigator.userAgent.indexOf("Mac")!=-1&&(t="Mac"),window.navigator.userAgent.indexOf("X11")!=-1&&(t="UNIX"),window.navigator.userAgent.indexOf("Linux")!=-1&&(t="Linux"),/android/i.test(window.navigator.userAgent)&&(t="Android"),/iPad|iPhone|iPod/i.test(window.navigator.userAgent)&&(t="iOS"),/windows phone/i.test(window.navigator.userAgent)&&(t="Windows Phone"),t},l.capturarMetrics=function(){return{hostname:document.location.hostname,url_pagina_origem:document.location.href,path_pagina_origem:document.location.pathname,navegador:l.navegadorAtual(),os:l.sistemaOperacionalAtual(),largura:AlobotJQuery(window).width(),altura:AlobotJQuery(window).height(),primeiro_referrer:l.tracker&&l.tracker.primeiroReferrer()||"",referrer:document.referrer}},l.dataAtualString=function(){var t=new Date,e=t.getUTCFullYear(),o=t.getUTCMonth()+1,a=t.getUTCDate(),i=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds();return o<10&&(o="0"+o),a<10&&(a="0"+a),n<10&&(n="0"+n),r<10&&(r="0"+r),i<10&&(i="0"+i),e+"-"+o+"-"+a+" "+i+":"+n+":"+r},l.upload=function(t,e){var o=new FormData;o.append("file",t);var a="?anexavel_type=chat_sala_atendimentos";l.cache("id_atendimento")&&(a+="&anexavel_id="+l.cache("id_atendimento"));var i=l.url+"/arquivos"+a;AlobotJQuery.ajax({url:i,type:"POST",data:o,processData:!1,contentType:!1,success:function(t){e(t)}})},l.inicializarSemConvite=function(){this._somenteAtendimento=!0,l.cache("id_atendimento")&&l.cache("atendimento_status")&&l.mostrarStatusAtendimento()},l.open=function(){this._somenteAtendimento=!0,l.mostrarPrimeiraInteracao()},l.somenteAtendimento=function(){return this._somenteAtendimento===!0},l.minimizar=function(){if(l.config.fullscreen){var t=window.self;return t.opener=window.self,void t.close()}l.minimizado=!0,l.chat.view&&l.chat.view.$elm?(l.chat.view.$elm.addClass("alobot-chat-minimizando"),setTimeout(function(){l.chat.view.$elm.removeClass("alobot-chat-minimizando"),l.somenteAtendimento()?l.esconderAtendimento():l.mostrarConvite()},250)):l.somenteAtendimento()?l.esconderAtendimento():l.mostrarConvite()},l.adicionarClasseConvite=function(){l.$container.addClass("alobot-convite"),l.config.mobile&&l.$wrapper.css("width",this.opts.convite.altura+"px").css("height",this.opts.convite.altura+"px").css("top","auto").css("bottom","0").css("left","auto !important").css("right","0 !important").css("margin-right","10px")},l.removerClasseConvite=function(){l.$container.removeClass("alobot-convite"),l.config.mobile&&l.$wrapper.removeAttr("style")},l.mostrarConvite=function(){l.config.fullscreen?l.mostrarPrimeiraInteracao():(l.convite=new l.Convite(this.opts.convite),l.convite.render(l.$container),l.convite.registrarEventos(),l.componenteAtual=l.convite,l.adicionarClasseConvite())},l.esconderAtendimento=function(){l.$container.empty()},l.estaAberto=function(){var t=l.$container.find(".alobot-convite");return 0==t.length&&l.$container.find("div").length>0},l.mostrarPrimeiraInteracao=function(t){return t=t||{},l.minimizado=!1,l.removerClasseConvite(),l.contemTodosParametrosParaIniciarAtendimento()?void(l.cache("id_atendimento")&&l.cache("atendimento_status")?l.Atendimento.status(l.cache("id_atendimento"),function(t){t.atendimento.id_departamento==l.getConfig("id_departamento")?l.mostrarStatusAtendimento():l.iniciarAtendimentoComParametrosInternos()}):l.iniciarAtendimentoComParametrosInternos()):void(l.cache("id_atendimento")&&l.cache("atendimento_status")?l.mostrarStatusAtendimento():t.pularConvite||l.getConfig("fullscreen")||l.somenteAtendimento()?l.mostrarIdentificacaoChat(function(){}):l.mostrarConvite())},l.restaurar=function(){l.restaurado=!0,setTimeout(function(){l.restaurado=!1},1e3),l.removerClasseConvite(),l.cache("id_atendimento")&&l.cache("atendimento_status")?l.mostrarStatusAtendimento():l.mostrarIdentificacaoChat(),l.minimizado=!1},l.mostrarIdentificacaoChat=function(t){if(l.garantirSocketIOCarregado(function(){}),l.getConfig("abrirPopup")){for(var e={},o=l.config,a=l.argConfig,i=Object.keys(o||{}),n=Object.keys(a||{}),r=0;r<i.length;r++){var s=i[r];"url"!=s&&"socketPrefix"!=s&&"rtsUrl"!=s&&"convite"!=s&&"chat"!=s&&"disponibilidade"!=s&&"id_filial"!=s&&"token_filial"!=s&&"config"!=s&&(e[s]=o[s])}for(var r=0;r<n.length;r++){var s=n[r];e[s]=a[s]}var c=l.url+"/chat/atendimentos/standalone?token="+l.tokenPersonalizacao+"&"+AlobotJQuery.param(e);return void window.open(c,null,"height=400,width=350,status=no,toolbar=no,menubar=no,location=no")}l.ChatUtils.opts=l.opts.chat,l.removerClasseConvite();var d=l.chatViewClass(),m=new d(l.$container,l.opts.chat),u=new l.ChatController(m,l.opts.chat);u.abrirIdentificacao(function(){l.Trigger.removerAvisos(),t&&t()}),l.chat=u,l.componenteAtual=u},l.mostrarStatusAtendimento=function(){l.Trigger.removerAvisos(),l.ChatUtils.opts=this.opts.chat;var t=(l.cache("atendimento_status"),l.cache("id_atendimento"));l.cache("tendimento_indice");if(t){var e=l.chatViewClass(),o=new e(l.$container,this.opts.chat),a=new l.ChatController(o,this.opts.chat);a.verificarStatus(t,function(){},{abrirIdentificacao:!0}),a.verificarStatusEmLoop(t),l.chat=a,l.componenteAtual=a}},l.tokenIdentificador=function(){var t=l.cache("alobot_tid");if(t)return t;var e=Math.random().toString(36).substring(2,36);return e=(new Date).getTime().toString()+e,l.cache("alobot_tid",e),e},l.normalizarCookieKey=function(t){var e=l.tokenPersonalizacao;return e&&(e=e.toString().substring(0,8),t=e+"_"+t),t};var d={};l.cache=function(t,e,o){if(t=l.normalizarCookieKey(t),o=o||{},e)l.bloquearCookies?d[t]=e:(window.location.protocol.indexOf("https")!==-1&&(o.sameSite="None",o.secure=!0),AlobotCookies.set(t,e,o));else{if(!l.bloquearCookies)return AlobotCookies.get(t);d[t]=e}},l.removeCache=function(t){t=l.normalizarCookieKey(t),l.bloquearCookies?delete d[t]:(AlobotCookies.remove(t),AlobotCookies.remove(t,{domain:document.location.hostname}))},l.conectar=function(t){l.garantirSocketIOCarregado(function(){return l.conectado?void t():(l.socketInicializada=!1,l.socket=AlobotIO(l.rtsUrl,{path:l.socketPath}),l.tentativasConexao=0,l.socket.on("connect",function(){l.conectado=!0,l.registrarEventos(),l.tentativasConexao=0,t&&t()}),l.socket.on("reconnect_attempt",function(){l.tentativasConexao+=1}),l.socket.on("reconnect",function(t){l.conectado=!0,l.tentativasConexao=0,l.mostrarStatusAtendimento()}),void l.socket.on("disconnect",function(){l.conectado=!1}))})},l.registrarEventos=function(){var t=l.socket;if(!l.socketInicializada){l.socketInicializada=!0,t.on("NovaMensagemAtendimento",function(t){l.minimizado?(l.start(),l.minimizado=!1):l.chat.renderMensagem(t.mensagem,{alertas:!0})}),t.on("AtendimentoAceito",function(t){l.chat.verificarStatus(t.atendimento.id),"ativo"==l.cache("atendimento_status")}),t.on("AtendimentoTransferido",function(t){l.respeitarFilaTransferencia()&&l.chat.verificarStatus(t.atendimento.id)}),t.on("AtendimentoEncerrado",function(t){"AtendimentoEncerrado"==l.ignorarProximoEvento?(l.ignorarProximoEvento=null,l.chat.encerrarSocketAtendimento(t.atendimento.id)):l.chat.encerrar(t.atendimento,t.mensagem)}),t.on("OperadorDigitando",function(t){l.chat.renderOperadorDigitandoFeedback()}),t.on("OperadorParouDeDigitar",function(t){l.chat.removerOperadorDigitandoFeedback()});var e=0;t.on("FilaAtualizada",function(t){var o=l.cache("contador"),a=l.cache("atendimento_status"),i=parseInt(t.contador_ultimo_atendido);if("ativo"!=a){var n=Math.max(1,parseInt(o)-i),r=parseInt(l.cache("atendimento_indice"));i>e&&(n=Math.max(r-1,1),l.atualizarIntervaloDeVerificacaoDeAcordoComPosicaoNaFila(n),l.cache("atendimento_indice",n),l.chat.renderAguardando(null,n))}e=i})}},l.mostrarChat=function(){}}(),function(){function t(t){return t=t.split(":"),[parseInt(t[0]),parseInt(t[1]),parseInt(t[2]||"0")]}var e=AlobotClient.Configuracao={};e.inicializar=function(t){t()},e.possuiAlgumDepartamentoOnline=function(){var t=AlobotClient.opts.disponibilidade;if(!t)return!0;e.estaEmHorarioDeTrabalho();for(var o in t)if(t[o])return e.estaEmHorarioDeTrabalho();return!1},e.estaEmHorarioDeAlmoco=function(){if(!AlobotClient.getConfig("habilitarHorarioAlmoco"))return!1;var e=AlobotClient.opts.config||{},o=e.timezone_offset,a=(new Date).getTimezoneOffset()*-60,i=(Math.abs(o+a),new Date),n=(i.getDay(),i.getDate()),r=i.getMonth(),l=i.getFullYear(),s=(60*i.getHours()*60+60*i.getMinutes()+i.getSeconds(),AlobotClient.getConfig("horarioAlmocoInicio")),c=AlobotClient.getConfig("horarioAlmocoFim"),d=t(s),m=t(c),u=new Date(l,r,n,d[0],d[1],d[2]),p=new Date(l,r,n,m[0],m[1],m[2]),h=parseInt(i.getTime()/1e3),f=parseInt(u.getTime()/1e3)-o+a,v=parseInt(p.getTime()/1e3)-o+a;return h>=f&&h<=v},e.estaEmHorarioDeTrabalho=function(){var o=AlobotClient.opts.config||{};if(!o.status_horario_trabalho)return!e.estaEmHorarioDeAlmoco();var a=o.timezone_offset,i=(new Date).getTimezoneOffset()*-60,n=(Math.abs(a+i),new Date),r=n.getDay(),l=n.getDate(),s=n.getMonth(),c=n.getFullYear(),d=(60*n.getHours()*60+60*n.getMinutes()+n.getSeconds(),["dom","seg","ter","qua","qui","sex","sab"]),m=d[r],u=o[m],p=t(o[m+"_i"]),h=t(o[m+"_f"]);if(!u)return!1;var f=new Date(c,s,l,p[0],p[1],p[2]),v=new Date(c,s,l,h[0],h[1],h[2]),b=parseInt(n.getTime()/1e3),g=parseInt(f.getTime()/1e3)-a+i,_=parseInt(v.getTime()/1e3)-a+i,A=b>=g&&b<=_;return A&&!e.estaEmHorarioDeAlmoco()}}(),function(){function t(t,i){a&&i(),o.indexOf(i)==-1&&o.push(i),o.length>1||AlobotJQuery.ajax({url:AlobotClient.normalizarUrl(AlobotClient.url)+"/alobot/"+t+".json",success:function(t){a=!0,e.data=t;for(var i=0;i<o.length;i++)o[i]()},error:function(){AlobotJQuery.ajax({url:AlobotClient.normalizarUrl(AlobotClient.url)+"/alobot/pt_br.json",success:function(t){a=!0,e.data=t;for(var i=0;i<o.length;i++)o[i]()},error:function(){console.log("Nenhum arquivo de linguagem :(")}})}})}var e=AlobotClient.I18n={},o=[],a=!1;e.inicializar=function(e){t(AlobotClient.linguagemDoCliente(),e)},e.corrigirAcentos=function(t){var e={"À":"&Agrave;","È":"&Egrave;","Ì":"&Igrave;","Ò":"&Ograve;","Ù":"&Ugrave;","à":"&agrave;","è":"&egrave;","ì":"&igrave;","ò":"&ograve;","ù":"&ugrave;","Á":"&Aacute;","É":"&Eacute;","Í":"&Iacute;","Ó":"&Oacute;","Ú":"&Uacute;","Ý":"&Yacute;","á":"&aacute;","é":"&eacute;","í":"&iacute;","ó":"&oacute;","ú":"&uacute;","ý":"&yacute;","Â":"&Acirc;","Ê":"&Ecirc;","Î":"&Icirc;","Ô":"&Ocirc;","Û":"&Ucirc;","â":"&acirc;","ê":"&ecirc;","î":"&icirc;","ô":"&ocirc;","û":"&ucirc;","Ã":"&Atilde;","Ñ":"&Ntilde;","Õ":"&Otilde;","ã":"&atilde;","ñ":"&ntilde;","õ":"&otilde;","Ç":"&Ccedil;","ç":"&ccedil;","¡":"&iexcl;","¿":"&iquest;","°":"&deg;"};for(var o in e)t=t.replace(o,e[o]);return t},e.t=function(t,o){o=o||{};for(var a=e.data&&e.data[t]||"",i=Object.keys(o),n=0;n<i.length;n++)a=a.replace("%"+i[n]+"%",o[i[n]]);return a}}(),AlobotClient.Trigger={mostrados:[],inicializar:function(){var t=AlobotClient.opts&&AlobotClient.opts.triggers;if(t)for(var e=0;e<t.length;e++)AlobotClient.Trigger.registrarTrigger(t[e])},verificarDisponibilidade:function(t){var e=AlobotClient.Configuracao.possuiAlgumDepartamentoOnline();return!("online"!=t.disponibilidade||!e)||("offline"==t.disponibilidade&&!e||"ambos"==t.disponibilidade)},verificarReferrer:function(t){if(""==t.site_origem)return!0;for(var e=t.site_origem.split(","),o=0;o<e.length;o++)if(e[o].trim().length>0&&document.referrer.indexOf(e[o])!=-1)return!0;return!1},verificarPaginaSite:function(t){if(""==t.pagina_site)return!0;for(var e=t.pagina_site.split(","),o=0;o<e.length;o++)if(e[o].trim().length>0&&document.location.pathname.indexOf(e[o])!=-1)return!0;return!1},verificarHorario:function(t){if(!t.horario_inicio&&!t.horario_fim)return!0;if("00:00"==t.horario_inicio&&"00:00"==t.horario_fim)return!0;var e=new Date,o=(e.getDay(),e.getDate()),a=e.getMonth(),i=e.getFullYear(),n=t.horario_inicio.split(":"),r=t.horario_fim.split(":"),l=new Date(i,a,o,n[0],n[1],"00"),s=new Date(i,a,o,r[0],r[1],"00");return e.getTime()>=l.getTime()&&e.getTime()<s.getTime()},removerAvisos:function(){var t=AlobotJQuery(".alobot-wrapper");t.find(".alobot-trigger-aviso-mensagem").remove(),t.find(".alobot-trigger-aviso-mensagem-arrow").remove();var e=t.find(".alobot-trigger-aviso-contador");return e.remove(),+e.text()},renderAviso:function(t,e){var o=(AlobotClient.Trigger.removerAvisos()||0)+1,a=AlobotJQuery(".alobot-wrapper .alobot-convite-circulo-flutuante"),i=a.find("img"),n=i.height(),r=n<58?.43:.52,l="";l+="; bottom: "+(n*r-15)+"px",l+="; right: "+(n+15)+"px";var s="escuro"==t.cor_mensagem_gatilho?"alobot-mensagem-escura":"transparente"==t.cor_mensagem_gatilho?"alobot-mensagem-transparente":"",c=JSON.stringify(t),d="<div data-trigger='"+c+"' class=\"alobot-trigger alobot-trigger-aviso-mensagem "+s+'" style="'+l+'">';d+=e.mensagem;var m="escuro"==t.cor_mensagem_gatilho?"alobot-trigger-fechar-escuro":"";d+='<div class="alobot-trigger-fechar '+m+'">&#10006;</div>',d+="</div>";var u="";u+="; bottom: "+n*r+"px",u+="; right: "+(n+10)+"px";var p="escuro"==t.cor_mensagem_gatilho?"alobot-arrow-escura":"transparente"==t.cor_mensagem_gatilho?"alobot-arrow-transparente":"";d+='<div class="alobot-trigger-aviso-mensagem-arrow '+p+'" style="'+u+'"></div>';var h="";if(h+="; top: "+.05*n+"px",h+="; right: "+.05*n+"px",d+='<div class="alobot-trigger-aviso-contador" style="'+h+'">'+o+"</div>",a.length){if(AlobotClient.cache("desabitar_gatilhos"))return;a.append(d),t.mensagem_avatar&&i.attr("src",t.mensagem_avatar)}else AlobotClient.chat&&!AlobotClient.estaEmAtendimento()&&AlobotClient.chat.view&&"atendimento"==AlobotClient.chat.view.view&&AlobotClient.chat.renderMensagem({id_usuario:1,mensagem:e.mensagem,url_avatar:t.mensagem_avatar||AlobotClient.opts.chat.headerAvatarUrl},{manterCabecalho:!0,safe:!0});AlobotClient.Trigger.mostrados.push({mensagem:e.mensagem,avatar:t.mensagem_avatar})},executarTrigger:function(t,e){return"abrir_alobot"==t.acao_gatilho?void AlobotClient.start():"abrir_atendimento_direto"==t.acao_gatilho?(AlobotClient.Trigger.abrirAtendimentoDireto=!0,AlobotClient.Trigger.atendimentoDiretoIdDepartamento=t.id_departamento,void AlobotClient.start()):"mostrar_aviso"==t.acao_gatilho?void AlobotClient.Trigger.renderAviso(t,e):void 0},registrarTrigger:function(t){if(AlobotClient.Trigger.verificarDisponibilidade(t)&&AlobotClient.Trigger.verificarReferrer(t)&&AlobotClient.Trigger.verificarPaginaSite(t)&&AlobotClient.Trigger.verificarHorario(t))if("mostrar_aviso"==t.acao_gatilho)for(var e=0;e<t.mensagens.length;e++){var o=t.mensagens[e];!function(e){setTimeout(function(){AlobotClient.Trigger.executarTrigger(t,e)},1e3*+e.tempo_visita)}(o)}else setTimeout(function(){AlobotClient.Trigger.executarTrigger(t)},1e3*+t.tempo_visita)}},function(){var t=this.AlobotClient.Convite=function(t){this.opts=t};t.prototype.registrarEventos=function(){var t=this;this.$elm.find(".alobot-convite").on("click",function(e){e.preventDefault();var o=AlobotJQuery(e.target);if(o.hasClass("alobot-trigger-fechar"))return void t.desabilitarGatilhos();if(AlobotClient.minimizado)AlobotClient.restaurar();else{if(t.possuiGatilhoAtivo()){var a=AlobotClient.Trigger.mostrados[AlobotClient.Trigger.mostrados.length-1];if(a&&"abrir_link"==a.acao_click)return void(window.location.href=a.abrir_link_url)}AlobotClient.mostrarIdentificacaoChat()}})},t.prototype.desabilitarGatilhos=function(){this.$elm.find(".alobot-trigger").remove(),this.$elm.find(".alobot-trigger-fechar").remove(),this.$elm.find(".alobot-trigger-aviso-mensagem-arrow").remove(),this.$elm.find(".alobot-trigger-aviso-contador").remove(),this.$elm.find(".alobot-convite img").attr("src",this.opts.iconeUrl),AlobotClient.cache("desabitar_gatilhos","true",{expires:new Date((new Date).getTime()+36e5)})},t.prototype.possuiGatilhoAtivo=function(){return this.$elm.find(".alobot-trigger").length>0},t.prototype.getGatilho=function(){var t=this.$elm.find(".alobot-trigger").attr("data-trigger");return JSON.parse(t)},t.prototype.renderEscondido=function(t){var e="",o="";o+=";height:"+this.opts.altura+"px",o+=";background-color:"+this.opts.corDeFundo,o+=";box-shadow: 0px 0px 0px 1px "+AlobotClient.escurecerCor(this.opts.corDeFundo,-20);var a="";a+=";height:"+this.opts.altura+"px";var i="";i+=";line-height:"+this.opts.altura+"px",i+=";color:"+this.opts.textoInicialCor,i+=";border-color:"+this.opts.corDeFundo,i+="#FFF"==this.opts.textoInicialCor?";text-shadow: 0px 0px 1px #004b8f":";text-shadow: 0px 0px 1px #FFF",e+='<div class="alobot-convite alobot-convite-escondido" style="'+o+'">',e+='<div class="alobot-convite-escondido-icone">',e+='<img src="'+this.opts.iconeUrl+'" style="'+a+'" />',e+="</div>",e+='<div class="alobot-convite-escondido-texto-inicial" style="'+i+'">',e+=this.opts.textoInicial,e+="</div>",e+="</div>",t.html(e)},t.prototype.renderAberto=function(t){var e="",o="";o+=";height:"+this.opts.altura+"px",o+=";background-color:"+this.opts.corDeFundo;var a="";a+=";height:"+(this.opts.altura-20)+"px";var i="";i+=";color:"+this.opts.textoInicialCor,e+='<div class="alobot-convite alobot-convite-aberto" style="'+o+'">',e+='<div class="alobot-convite-aberto-texto-inicial" style="'+i+'">',e+=this.opts.textoInicial,e+="</div>",e+='<div class="alobot-convite-aberto-imagem">',e+='<img src="'+this.opts.iconeUrl+'" style="'+a+'" />',e+="</div>",AlobotClient.isTransparente(this.opts.corDeFundo)||(e+='<div class="alobot-convite-aberto-border-bottom"></div>'),e+="</div>",t.html(e)},t.prototype.alturaDaImagemNoCirculoFlutuante=function(){return+this.opts.altura},t.prototype.renderCirculoFlutuante=function(t){var e="",o="";o+=";height:"+this.opts.altura+"px",o+=";width:"+this.opts.altura+"px",AlobotClient.isTransparente(this.opts.corDeFundo)&&(o+=";box-shadow: none; border: none;");var a="";a+=";height:"+(this.alturaDaImagemNoCirculoFlutuante()-6)+"px",a+=";position: absolute; top: 0; bottom: 0; margin: auto; left: 0; right: 0;",e+='<div class="alobot-convite alobot-convite-circulo-flutuante" style="'+o+'">',e+='<img src="'+this.opts.iconeUrl+'" style="'+a+'" />',e+="</div>",t.html(e)},t.prototype.render=function(t){this.$elm=t,AlobotClient.Configuracao.possuiAlgumDepartamentoOnline()||this.alterarConfiguracaoParaOffline(),"aberto"==this.opts.layout?this.renderAberto(t):"circulo_flutuante"==this.opts.layout?this.renderCirculoFlutuante(t):this.renderEscondido(t),AlobotClient.Resizer.fixHeight()},t.prototype.renderOffline=function(t){this.alterarConfiguracaoParaOffline(),this.render(t)},t.prototype.alterarConfiguracaoParaOffline=function(){this.opts=JSON.parse(JSON.stringify(this.opts)),this.opts.layout=this.opts.layoutOffline,this.opts.textoInicial=this.opts.textoInicialOffline,this.opts.textoInicialCor=this.opts.textoInicialCorOffline,this.opts.altura=this.opts.alturaOffline,this.opts.corDeFundo=this.opts.corDeFundoOffline,this.opts.iconeUrl=this.opts.iconeUrlOffline}}(),function(){AlobotClient.Atendimento={};var t=null;AlobotClient.atendimento=function(){return t&&t.atendimento?t.atendimento:{}},AlobotClient.__setarUltimoAtendimentoRequisicao=function(e){t=e};var e=[],o=!1;AlobotClient.Atendimento.status=function(a,i,n){
if(e.push(i),!o){o=!0;var r=AlobotClient.url+"/chat/atendimentos/"+a+"/status_alobot";n&&n.primeiraVisita&&(r+="?incluir_fila=true"),AlobotJQuery.get(AlobotClient.corrigirUrl(r),function(a){t=a;for(var i=0;i<e.length;i++)e[i](a);e=[],o=!1})}}}(),function(){function t(t){e(t.target.value)}function e(t){var e=i(t,c);o(r,e)}function o(t,e){a();var o=Object.keys(e),i="";if(i+='<div class="alobot_autocomplete_container">',d=e,o.length>0)for(var n=0;n<o.length;n++){var r=o[n],c=e[r];i+='<div class="alobot_autocomplete_option" data-key="'+r+'">'+c+"</div>"}else i+='<div class="alobot_autocomplete_nenhum_resultado">',i+="Nenhum resultado encontrado",i+="</div>";i+="</div>",s=AlobotJQuery(i),l.$elm.find(".alobot-chat-body").css("paddingBottom","80px"),l.scrollChatBodyToBottom(),s.find(".alobot_autocomplete_option").on("click",function(t){var e=AlobotJQuery(this).attr("data-key");l.emit("responder",e)}),t.parent().parent().parent().prepend(s)}function a(){l&&l.$elm.find(".alobot-chat-body").css("paddingBottom","15px"),s&&s.remove()}function i(t,e){for(var o={},a=Object.keys(e),i=0;i<a.length;i++)e[a[i]].toLowerCase().indexOf(t.toLowerCase())!==-1&&(o[a[i]]=e[a[i]]);return o}var n=AlobotClient.ChatAutocomplete={},r=null,l=null,s=null,c=null,d=[];n.inicializar=function(o,a,i){l=o,r=a,c=i,e(""),r.on("keyup",t)},n.desabilitar=function(){r&&(r.off("keyup",t),r.val("")),a()},n.aberto=function(){return s&&s.parent().length},n.capturarValor=function(){var t=Object.keys(d);return 0!=t.length&&(1==t.length&&t[0])}}(),function(t,e){var o=AlobotClient.ChatUtils={};o.mostrarFormularioMensagemOffline=function(){return this.opts.mostrarMensagemOffline===e||"1"==this.opts.mostrarMensagemOffline},o.mostrarAtendimentoIndisponivel=function(){return"0"==this.opts.mostrarMensagemOffline},o.iniciarAutoatendimento=function(){return"autoatendimento"==this.opts.mostrarMensagemOffline},o.buscarMapaDepartamentosAtualizado=function(t){var e="?";e+=AlobotClient.tokenFilial?"token="+AlobotClient.tokenFilial:"id_filial="+AlobotClient.idFilial,AlobotJQuery.ajax({url:AlobotClient.url+"/chat/departamentos/mapa"+e,success:function(e){AlobotClient.mapaDepartamentos=e,t(e)},error:function(e){AlobotClient.mapaDepartamentos=[],t([])}})},o.mapaDepartamentos=function(e){if(AlobotClient.mapaDepartamentos)return void e(AlobotClient.mapaDepartamentos);if(o.bloquearMapa)return AlobotClient.mapaDepartamentos=[],void e([]);if(t.alobotRequisitarMapaAtualizado||AlobotClient.getConfig("requisitarMapaAtualizado"))this.buscarMapaDepartamentosAtualizado(e);else{var a=this,i=AlobotClient.normalizarUrl(AlobotClient.url)+"/storage/mapa-filial-"+AlobotClient.tokenOuIdFilial()+".json?t="+AlobotClient.timestamp();AlobotJQuery.ajax({url:i,success:function(t){AlobotClient.mapaDepartamentos=t,e(t)},error:function(){a.buscarMapaDepartamentosAtualizado(e)}})}},o.possuiDepartamentoDisponivel=function(){for(var t=[],e=0;e<AlobotClient.mapaDepartamentos.length;e++){var o=AlobotClient.mapaDepartamentos[e];o.disponivel&&t.push(o)}return t.length>0},o.departamentosRootsDisponiveis=function(){if(!AlobotClient.mapaDepartamentos)return[];for(var t=[],e=0;e<AlobotClient.mapaDepartamentos.length;e++){var o=AlobotClient.mapaDepartamentos[e];!o.id_pai&&o.disponivel&&t.push(o)}return t},o.departamentosRootsIndisponiveis=function(){for(var t=[],e=0;e<AlobotClient.mapaDepartamentos.length;e++){var o=AlobotClient.mapaDepartamentos[e];o.id_pai||o.disponivel||t.push(o)}return t},o.departamentosRootsComStatus=function(){for(var t=[],e=0;e<AlobotClient.mapaDepartamentos.length;e++){var o=AlobotClient.mapaDepartamentos[e];if(!o.id_pai){var a=o.nome;o.disponivel||(a+=" (offline)"),o.nome=a,t.push(o)}}return t.sort(function(t,e){return t.nome>e.nome?-1:1}),t.sort(function(t,e){return t.disponivel?-1:1}),t},o.optionsDepartamentosRootsDisponiveis=function(){var t=o.departamentosRootsDisponiveis(),e=t.map(function(t){return'<option value="'+t.id+'">'+t.nome+"</option>"});return e.unshift('<option value="">Selecione...</option>'),e.join("")},o.optionsDepartamentosRootsIndisponiveis=function(){var t=o.departamentosRootsIndisponiveis(),e=t.filter(function(t){return 25!=t.id||0!=t.disponivel}).map(function(t){return'<option value="'+t.id+'">'+t.nome+"</option>"});return e.unshift('<option value="">Selecione...</option>'),e.join("")},o.optionsDepartamentosRootsComStatus=function(){var t=o.departamentosRootsComStatus(),e=t.filter(function(t){return!0}).map(function(t){return t.disponivel?'<option value="'+t.id+'">'+t.nome+"</option>":'<option value="'+t.id+'" style="background-color: #ffe4e0;">'+t.nome+"</option>"});return e.unshift('<option value="">Selecione...</option>'),e.join("")},o.departamentoEstaDisponivel=function(t){var e=o.dadosDoDepartamento(t);return e&&e.disponivel},o.possuiSubdepartamento=function(t){return o.subdepartamentos(t).length>0},o.subdepartamentos=function(t){for(var e=[],o=0;o<AlobotClient.mapaDepartamentos.length;o++){var a=AlobotClient.mapaDepartamentos[o];a.id_root==t&&e.push(a)}return e},o.subdepartamentosComStatus=function(t){for(var e=[],o=0;o<AlobotClient.mapaDepartamentos.length;o++){var a=AlobotClient.mapaDepartamentos[o];if(a.id_root==t){var i=a.nome;a.disponivel||a.nome.indexOf("offline")!=-1||(i+=" (offline)"),a.nome=i,e.push(a)}}return e.sort(function(t,e){return t.disponivel?-1:1}),e},o.subdepartamentosDisponiveis=function(t){for(var e=[],o=0;o<AlobotClient.mapaDepartamentos.length;o++){var a=AlobotClient.mapaDepartamentos[o];a.id_root==t&&a.disponivel&&e.push(a)}return e},o.subdepartamentosIndisponiveis=function(t){for(var e=[],o=0;o<AlobotClient.mapaDepartamentos.length;o++){var a=AlobotClient.mapaDepartamentos[o];a.id_root!=t||a.disponivel||e.push(a)}return e},o.dadosDoDepartamento=function(t){if(!AlobotClient.mapaDepartamentos)return null;for(var e,o=0;o<AlobotClient.mapaDepartamentos.length;o++){var a=AlobotClient.mapaDepartamentos[o];if(a.id==t){e=a;break}}return e},o.horarioDaMensagem=function(t){var e=/(\d{4})-(\d{2})-(\d{2})\s(\d{2})\:(\d{2})\:(\d{2})/,o=e.exec(t.created_at);if(o){var a=new Date(Date.UTC(+o[1],+o[2]-1,+o[3],+o[4],+o[5],+o[6])),i=a.getMinutes();i<10&&(i="0"+i);var n=a.getHours();return n<10&&(n="0"+n),n+":"+i}return""},o.disponivel=function(){if(o.forcarIndisponivel!==e)return!o.forcarIndisponivel;if(!AlobotClient.Configuracao.estaEmHorarioDeTrabalho())return!1;if(AlobotClient.getConfig("id_departamento")){var t=o.dadosDoDepartamento(AlobotClient.getConfig("id_departamento"));return t&&t.disponivel}var a=o.departamentosRootsDisponiveis();return a.length>0}}(window),function(t,e){var o=AlobotClient.ChatUtils,a=AlobotClient.I18n,i=this.AlobotClient.ChatController=function(t,e){this.view=t,this.opts=e||{},this.view.on("select_departamento",this.onSelecionarDepartamento.bind(this)),this.view.on("select_subdepartamento",this.onSelecionarSubdepartamento.bind(this)),this.view.on("iniciar_atendimento",this.onIniciarAtendimento.bind(this)),this.view.on("spy_text",this.onSpyText.bind(this)),this.view.on("responder",this.onResponder.bind(this)),this.view.on("pedido_encerramento",this.onPedidoEncerramento.bind(this)),this.view.on("encerrar_atendimento",this.onEncerrarAtendimento.bind(this)),this.view.on("encerrar_socket_atendimento",this.onEncerrarSocketAtendimento.bind(this)),this.view.on("limpar_cache",this.onLimparCache.bind(this)),this.view.on("minimizar",this.onMinimizar.bind(this)),this.view.on("abandonar_atendimento",this.onAbandonarAtendimento.bind(this)),this.view.on("enviar_mensagem_offline",this.onEnviarMensagemOffline.bind(this)),this.view.on("avaliar",this.onAvaliar.bind(this))};i.prototype.abrirIdentificacao=function(t){var e=this;this.view.renderIdentificacao(function(){t&&t(),e.opts.integracaoIdentificacao&&!AlobotClient.ChatUtils.bloquearEventos&&e.view.$elm.find(".alobot-chat-identificacao").append(e.opts.integracaoIdentificacao)})},i.prototype.onSelecionarDepartamento=function(t){this.view.removerCamposAdicionais();var e=o.departamentoEstaDisponivel(t)&&AlobotClient.Configuracao.estaEmHorarioDeTrabalho();this.view.removerSelectSubdepartamento(),e?this.view.atualizarParaMensagemOnline():this.view.atualizarParaMensagemOffline(),this.iniciarSelectSubdepartamento(t)},i.prototype.onSelecionarSubdepartamento=function(t){if(this.view.removerCamposAdicionais(),t){var e=o.departamentoEstaDisponivel(t)&&AlobotClient.Configuracao.estaEmHorarioDeTrabalho();e?this.view.atualizarParaMensagemOnline():this.view.atualizarParaMensagemOffline(),this.mostrarCamposAdicionais(t)}},i.prototype.verificarStatusEmLoop=function(t){var e=this;AlobotClient._intervalStatusEmLoop&&clearInterval(AlobotClient._intervalStatusEmLoop);AlobotClient._intervalStatusEmLoop=setInterval(function(){"ativo"!=AlobotClient.cache("atendimento_status")&&AlobotClient.cache("id_atendimento")&&!e.encerrado?e.verificarStatus(t):(clearInterval(AlobotClient._intervalStatusEmLoop),e.verificarAtendimentoInicializado())},AlobotClient.verificacaoStatusInterval)},i.prototype.onIniciarAtendimento=function(t){function e(){return a+=1,a>3?"avisar que algo está errado.":void AlobotJQuery.ajax({type:"POST",url:AlobotClient.url+"/chat/atendimentos",data:t,timeout:1e4,success:function(t){t.atendimento||(t.atendimento={}),AlobotClient.__setarUltimoAtendimentoRequisicao(t),o.mostrarStatusAtendimento(t.status,t.atendimento.id,t.indice,t.atendimento),o.verificarStatusEmLoop(t.atendimento.id)},error:function(t,o,a){"timeout"==o||e()}})}AlobotClient.cache("alobot_nome",t.nome),AlobotClient.cache("alobot_email",t.email),t.metrics=AlobotClient.capturarMetrics(),t.historico_navegacao=AlobotClient.tracker&&AlobotClient.tracker.visitasJson()||[];var o=this,a=0;t.id_filial=AlobotClient.tokenOuIdFilial(),t.linguagem=AlobotClient.linguagemDoCliente(),AlobotClient.getConfig("habilitarHorarioAlmoco")&&AlobotClient.Configuracao.estaEmHorarioDeAlmoco()&&(t.forcar_mensagem_offline=1),e()},i.prototype.onSpyText=function(t){AlobotClient.estaEmAtendimento()&&AlobotClient.socket.emit("message",{canal:"atendimento."+AlobotClient.cache("id_atendimento"),event:"SpyText",params:{id_atendimento:AlobotClient.cache("id_atendimento"),mensagem:btoa(t)}})},i.prototype.onResponder=function(t,e){this.view.removerOptionsCasoExista(),this.view.renderMensagem({id_contato:-1,mensagem:AlobotClient.stripHTML(t),nome_envio:AlobotClient.cache("alobot_nome"),created_at:AlobotClient.dataAtualString(),url_avatar:""});var o=AlobotClient.cache("id_atendimento");AlobotJQuery.post(AlobotClient.url+"/chat/atendimentos/"+o+"/responder_alobot",{mensagem:t,mensagem_escondida:e||null,origem:"contato"},function(){})},i.prototype.onPedidoEncerramento=function(){this.encerrado?this.onMinimizar():this.view.renderConfirmacaoEncerramento()},i.prototype.onEncerrarAtendimento=function(t,e){var o=AlobotClient.url+"/chat/atendimentos/"+t+"/encerrar_alobot?";this.encerradoPeloContato=!0;var a=this;e&&(o+=e),AlobotJQuery.get(o,function(t){a.encerrado=!0})},i.prototype.onAvaliar=function(t,e){e<=1&&this.view.adicionarFeedbackAposAvaliacao();var o=AlobotClient.url+"/chat/atendimentos/"+t+"/avaliar";AlobotJQuery.post(o,{avaliacao:e},function(t){})},i.prototype.abandonarAtendimento=function(t){var e="&abandono=1";this.onEncerrarAtendimento(AlobotClient.cache("id_atendimento"),e),this.onEncerrarSocketAtendimento(AlobotClient.cache("id_atendimento"),AlobotClient.cache("id_departamento"))},i.prototype.onEncerrarSocketAtendimento=function(t,e){AlobotClient.socket&&(AlobotClient.socket.emit("leave","atendimento."+t),e&&AlobotClient.socket.emit("leave","departamento."+e))},i.prototype.onLimparCache=function(){this.limparCacheAtendimento()},i.prototype.onMinimizar=function(){AlobotClient.minimizar()},i.prototype.onAbandonarAtendimento=function(){AlobotClient.cache("id_atendimento")&&(this.abandonarAtendimento(AlobotClient.cache("id_atendimento")),this.renderEnviarMensagemOffline())},i.prototype.renderEnviarMensagemOffline=function(){this.view.renderEnviarMensagemOffline()},i.prototype.onEnviarMensagemOffline=function(t,e){var o=this;AlobotJQuery.post(AlobotClient.url+"/chat/atendimentos/"+e+"/enviar_mensagem_offline",{mensagem:t},function(){o.renderSucessoMensagemOffline()})},i.prototype.iniciarSelectSubdepartamento=function(t){o.possuiSubdepartamento(t)?this.view.adicionarSubdepartamento(t):this.mostrarCamposAdicionais(t)},i.prototype.mostrarCamposAdicionais=function(t){if(t){var e=o.dadosDoDepartamento(t);e&&this.view.renderizarCamposAdicionais(e.campos_personalizados_html)}},i.prototype.mostrarStatusAtendimento=function(t,e,o,i){var n=i.created_since;this.atendimentoId=e,AlobotClient.cache("atendimento_status",t),"--"!=o&&(AlobotClient.atualizarIntervaloDeVerificacaoDeAcordoComPosicaoNaFila(o),AlobotClient.cache("atendimento_indice",o)),this.indice=o,"indisponivel"==t&&(3==i.status?(AlobotClient.cache("atendimento_status","ativo"),this.renderAtendimento(),this.carregarHistorico(e),this.escutarAtendimento(e,i.id_departamento,i.contador),this.verificarAtendimentoInicializado()):this.view.renderIndisponivel()),"mensagem_offline"==t&&this.renderSucessoMensagemOffline(),"aguardando"==t&&"aguardando"!=this.status&&(this.renderAguardando(n,o),this.escutarAtendimento(e,i.id_departamento,i.contador),AlobotClient.Alertas.pedirPermissaoWebNotification()),"error"==t&&this.view.renderErrorServidor(),"ativo"==t&&"ativo"!=this.status&&(this.renderAtendimento(),this.carregarHistorico(e),this.escutarAtendimento(e,i.id_departamento,i.contador),this.verificarAtendimentoInicializado(),AlobotClient.Alertas.emitir(a.t("atendimento_iniciado")));var r=this;"encerrado"==t&&(r.encerrado=!0,n>1?(this.onEncerrarSocketAtendimento(e,i.id_departamento),this.restaurarHeader({avatar:this.opts.headerAvatarUrl,nome:this.opts.headerNome}),this.limparCacheAtendimento(),AlobotClient.__setarUltimoAtendimentoRequisicao(null),AlobotClient.restaurado?this.abrirIdentificacao():AlobotClient.mostrarConvite()):(this.renderAtendimento(),this.carregarHistorico(e,function(){r.view.renderAcoesEncerrado(),r.view.registrarEventos(),r.restaurarHeader()}))),this.status=t},i.prototype.renderSucessoMensagemOffline=function(){this.view.renderSucessoMensagemOffline()},i.prototype.renderAtendimento=function(){this.view.renderAtendimento(),this.opts.integracaoAtendimentoIniciado&&!AlobotClient.ChatUtils.bloquearEventos&&this.view.$elm.find(".alobot-chat-body").append(this.opts.integracaoAtendimentoIniciado)},i.prototype.renderAguardando=function(t,e){this.view.renderAguardando(e);var o=this;if(null!=t){var a=+AlobotClient.opts.chat.timeoutSugestaoMensagemOffline-t;AlobotClient.mensagemOfflineTimeout&&clearTimeout(AlobotClient.mensagemOfflineTimeout),o.mensagemOfflineTimeout=AlobotClient.mensagemOfflineTimeout=setTimeout(function(){o.view.renderBotaoAbandonarAtendimento()},1e3*a)}this.opts.integracaoAguardandoEmFila&&!AlobotClient.ChatUtils.bloquearEventos&&this.view.$elm.find(".alobot_aguardando_personalizacao").append(this.opts.integracaoAguardandoEmFila)},i.prototype.escutarAtendimento=function(t,e,o){var a=this;AlobotClient.conectar(function(){return a.joinedAtendimento==t?"Já estou conectado!":(AlobotClient.socket.emit("join","atendimento."+t),AlobotClient.socket.emit("join","departamento."+e),AlobotClient.cache("id_atendimento",t),AlobotClient.cache("id_departamento",e),AlobotClient.cache("contador",o),void(a.joinedAtendimento=t))})},i.prototype.verificarStatus=function(t,e){var o={};this._primeiraVisita||(o.primeiraVisita=!0,this._primeiraVisita=!0);var a=this;AlobotClient.Atendimento.status(t,function(t){return a.ignorarVerificacaoStatus?void(a.ignorarVerificacaoStatus=!1):(console.log(t),a.mostrarStatusAtendimento(t.status,t.atendimento.id,t.indice,t.atendimento),void(e&&e()))},o)},i.prototype.limparCacheAtendimento=function(){AlobotClient.removeCache("atendimento_status"),AlobotClient.removeCache("id_atendimento"),AlobotClient.removeCache("id_departamento"),AlobotClient.removeCache("contador")},i.prototype.carregarHistorico=function(t,e){var o=this;AlobotJQuery.get(AlobotClient.url+"/chat/atendimentos/"+t+"/historico_alobot",function(t){for(var a=0;a<t.length;a++){var i=t[a];o.renderMensagem(i)}e&&e()})},i.prototype.verificarAtendimentoInicializado=function(){if(!this.timeoutVerificarAtendimentoInicializado){var t=this;this.timeoutVerificarAtendimentoInicializado=setTimeout(function(){function e(){AlobotClient.cache("id_atendimento")&&(t.view.$elm=AlobotClient.$container,t.verificarStatus(AlobotClient.cache("id_atendimento"),function(){t.timeoutVerificarAtendimentoInicializado=null}))}return t.view.$elm?0==t.view.$elm.find(".alobot-chat-body").length?void e():void(t.timeoutVerificarAtendimentoInicializado=null):void e()})}},i.prototype.renderOperadorDigitandoFeedback=function(){this.view.renderOperadorDigitandoFeedback()},i.prototype.renderMensagem=function(t,e){this.view.removerIndicadorLoadingAntesPrimeiraMensagem(),e=e||{},t.id_usuario&&this.avatarAtualHeader!=t.url_avatar&&!e.manterCabecalho&&(this.atualizarHeader({avatar:t.url_avatar,nome:t.nome_envio}),this.avatarAtualHeader=t.url_avatar),e.alertas&&t&&t.id_usuario&&AlobotClient.Alertas.emitir(t.mensagem),1==t.contem_html&&(e.safe=!0),e.safe||(t&&t.mensagem&&(t.mensagem=AlobotClient.stripHTML(t.mensagem),t.mensagem=AlobotClient.adicionarHiperlinks(t.mensagem)),t&&t.mensagem_original&&(t.mensagem_original=AlobotClient.stripHTML(t.mensagem_original),t.mensagem_original=AlobotClient.adicionarHiperlinks(t.mensagem_original))),this.view.renderMensagem(t)},i.prototype.renderStatus=function(t){this.renderMensagem(t)},i.prototype.encerrar=function(t,e){if(t){var o=t.id;this.onEncerrarSocketAtendimento(o,t.id_departamento),this.restaurarHeader({avatar:this.opts.headerAvatarUrl,nome:this.opts.headerNome})}t&&t.avaliacao||this.encerradoPeloContato?(this.view.renderAcoesEncerrado(),this.view.registrarEventos()):this.view.mostrarAvaliacaoAposEncerrado(),this.opts.integracaoAtendimentoFinalizado&&!AlobotClient.ChatUtils.bloquearEventos&&this.view.$elm.find(".alobot-chat-body").append(this.opts.integracaoAtendimentoFinalizado),AlobotClient.__setarUltimoAtendimentoRequisicao(null)},i.prototype.atualizarHeader=function(t){"1"==this.opts.mostrarAvatarOperador?AlobotClient.cache("alobot_header_avatar",t.avatar,{expires:3e5}):t.avatar=this.opts.headerAvatarUrl,"1"==this.opts.mostrarNomeOperador?AlobotClient.cache("alobot_header_nome",t.nome,{expires:3e5}):t.nome=this.opts.headerNome,this.view.atualizarHeader(t)},i.prototype.restaurarHeader=function(){AlobotClient.removeCache("alobot_header_avatar"),AlobotClient.removeCache("alobot_header_nome"),this.view.atualizarHeader({avatar:this.opts.headerAvatarUrl,nome:this.opts.headerNome})}}(window),function(t,e){var o=AlobotClient.ChatUtils,a=AlobotClient.I18n,i=AlobotClient.ChatDefaultView=function(t,e){this.$elm=t,this.opts=e||{},AlobotEventEmitter.call(this)};i.prototype=Object.create(AlobotEventEmitter.prototype),i.prototype.renderIdentificacao=function(t){var e=this;o.mapaDepartamentos(function(a){o.possuiDepartamentoDisponivel(),o.forcarIndisponivel,AlobotClient.Configuracao.estaEmHorarioDeTrabalho();if(o.disponivel());else if(o.mostrarAtendimentoIndisponivel())return e.renderAvisoDepartamentosIndisponiveis(),void(t&&t());var i="";i+='<div class="alobot-chat-container alobot-chat-no-input alobot-chat-identificacao '+e.layoutClasse()+'">',i+=e.gerarTituloHTML(),i+=e.gerarHeaderHTML(),i+=e.gerarIdentificacaoBodyHTML(),i+=e.gerarFooterGeralHTML(),i+="</div>",e.$elm.html(i),e.registrarEventos(),e.iniciarSelectDepartamento(),AlobotClient.Resizer.fixHeight(),t&&t(),!o.disponivel()&&o.iniciarAutoatendimento()&&"auto"==AlobotClient.getConfig("nome")&&"auto@auto.auto"==AlobotClient.getConfig("email")&&(e.$elm.find(".alobot-iniciar-atendimento-botao-container .alobot-form-group").css("opacity","0"),e.$elm.find(".alobot-iniciar-atendimento-botao-container button").attr("disabled",!0),setTimeout(function(){e.tentarIniciarAtendimento()},1e3))})},i.prototype.tentarIniciarAtendimento=function(){var t=this.$elm,e=t.find("#alobot_chat_nome").val(),o=t.find("#alobot_chat_email").val(),i=t.find("#alobot_chat_id_departamento").val(),n=t.find("#alobot_chat_primeira_mensagem").val();t.find("#alobot_chat_id_subdepartamento").length&&(i=t.find("#alobot_chat_id_subdepartamento").val()),t.find(".alobot-has-error").removeClass("alobot-has-error"),t.find(".alobot_validacao_msg").remove();var r=this,l=!0,s=t.find(".alobot-campo-adicional");s.each(function(){var t=AlobotJQuery(this),e=t.find("*[required]"),o=e.length>0;o&&!e.val()&&(l=!1,r.mostrarErroValidacao("#"+e.attr("id")))});var c=e&&e.length>2,d=!1;if(d=AlobotClient.getConfig("permitirQualquerEmail")?o&&o.length>0:o&&/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(o),c&&d&&i&&n&&l){t.find("#enviar").html(a.t("processando")),t.find("#enviar").attr("disabled",!0);var m={id_departamento:i,nome:e,email:o,primeira_mensagem:n};this.capturarValoresCamposAdicionais(m),this.emit("iniciar_atendimento",m)}else n||r.mostrarErroValidacao("#alobot_chat_primeira_mensagem"),i||(t.find("#alobot_chat_id_subdepartamento").length?this.mostrarErroValidacao("#alobot_chat_id_subdepartamento"):this.mostrarErroValidacao("#alobot_chat_id_departamento")),d||this.mostrarErroValidacao("#alobot_chat_email","Email inválido."),c||this.mostrarErroValidacao("#alobot_chat_nome")},i.prototype.registrarEventos=function(){if(!o.bloquearEventos){var t=this.$elm.find(".alobot-chat-identificacao"),e=this,a=this.$elm.find(".alobot-chat-body");a.unbind("click"),a.find("#fechar_janela_atendimento").unbind("click").bind("click",function(){e.emit("limpar_cache"),e.emit("minimizar")}),this.$elm.find("#ok_atendimento_encerrado_por_indisponibilidade").off("click").on("click",function(){AlobotClient.cache("id_atendimento")&&(e.cacheIdAtendimento=AlobotClient.cache("id_atendimento")),e.emit("abandonar_atendimento")}),this.$elm.find(".minimizar").unbind("click").bind("click",function(){e.emit("minimizar")}),this.$elm.find(".encerrar").unbind("click").bind("click",function(){e.emit("pedido_encerramento")}),this.$elm.find("#alobot_chat_id_departamento").unbind("change").bind("change",function(){var t=AlobotJQuery(this).val();e.emit("select_departamento",t)}),this.$elm.find("#alobot_chat_id_subdepartamento").unbind("change").bind("change",function(){var t=AlobotJQuery(this).val();e.emit("select_subdepartamento",t)}),this.$elm.find("#abrir_mensagem_offline").unbind("click").bind("click",function(){AlobotClient.cache("id_atendimento")&&(e.cacheIdAtendimento=AlobotClient.cache("id_atendimento")),e.emit("abandonar_atendimento")});var i=AlobotClient.cache("id_atendimento");this.$elm.find("#enviar_mensagem_offline").unbind("click").bind("click",function(){var t=e.$elm.find("#alobot_chat_mensagem_offline").val();e.emit("enviar_mensagem_offline",t,i||e.cacheIdAtendimento)}),t.find("#enviar").unbind("click").bind("click",function(){e.tentarIniciarAtendimento()});var n=this.$elm.find(".alobot-chat-input-container"),r=new Date,l=null;n.find(".alobot-chat-input-textarea").unbind("keydown keypress keyup").bind("keydown",function(t){var o=AlobotJQuery(this).val();if(l&&clearTimeout(l),13==t.which){if(""==o.trim())return t.preventDefault();if(t.shiftKey)return t.preventDefault();if(AlobotClient.ChatAutocomplete.aberto()&&(o=AlobotClient.ChatAutocomplete.capturarValor(),!o))return t.preventDefault();t.preventDefault(),e.emit("responder",o),AlobotJQuery(this).val("")}else(new Date).getTime()-r.getTime()>2500?(e.emit("spy_text",o),r=new Date):l=setTimeout(function(){e.emit("spy_text",o)},2500)}),n.find(".alobot-chat-input-textarea").on("focus",function(){}),n.find(".alobot-chat-input-textarea").on("blur",function(){AlobotJQuery(this).css("border-top-color","#DFDFDF"),AlobotJQuery(this).css("border-bottom-color","#ffffff"),AlobotJQuery(this).css("border-left-color","#A0A0A0"),AlobotJQuery(this).css("border-right-color","#A0A0A0")}),n.find("#alobot_chat_anexo").unbind("change").bind("change",function(){var t=t=AlobotClient.url+"/chat/atendimentos/"+AlobotClient.cache("id_atendimento")+"/enviar_arquivo",e=AlobotJQuery(this).parents("form"),o=new FormData(e[0]);e.find("label").hide(),e.append('<i class="feedback alobot-icon-processando" style="margin-right: 3px;"></i>'),AlobotJQuery.ajax({type:"POST",url:t,data:o,processData:!1,contentType:!1,success:function(t){e.find(".feedback").remove(),e.find("label").show()},error:function(t){}})})}},i.prototype.renderErrorServidor=function(){var t="";t+='<div class="alobot-chat-container alobot-chat-no-input alobot-chat-mensagem-offline '+this.layoutClasse()+'">',t+=this.gerarTituloHTML(),t+=this.gerarHeaderHTML(),t+='<div class="alobot_aguardando-em-fila">',t+=a.t("erro_no_servidor"),t+="</div>",t+='<div class="alobot_aguardando_personalizacao">',t+="</div>",t+=this.gerarFooterGeralHTML(),t+="</div>",this.$elm.html(t),this.registrarEventos()},i.prototype.removerCamposAdicionais=function(){this.$elm.find(".alobot-campo-adicional").remove()},i.prototype.removerSelectSubdepartamento=function(){this.$elm.find(".subdepartamento-container").remove()},i.prototype.atualizarParaMensagemOnline=function(){this.$elm.find("#enviar").html(a.t("iniciar_atendimento"))},i.prototype.atualizarParaMensagemOffline=function(){return o.iniciarAutoatendimento()&&this.opts.id_bot?void this.atualizarParaAutoAtendimento():void this.$elm.find("#enviar").html(a.t("enviar_mensagem_offline"))},i.prototype.atualizarParaAutoAtendimento=function(){this.$elm.find("#enviar").html(a.t("iniciar_autoatendimento"))},i.prototype.renderizarCamposAdicionais=function(t){var e=AlobotJQuery(t);e.find(".form-group").addClass("alobot-form-group alobot-campo-adicional").removeClass("form-group"),e.find(".form-control").addClass("alobot_form_input").removeClass("form-control"),e.find("label").addClass("alobot_label");var o=e.find(".alobot-form-group");o.each(function(){var t=AlobotJQuery(this),e=AlobotJQuery(this).find("input,select,textarea");e.attr("data-campo-adicional","1"),e.remove();t.append(e);var o=e.attr("id");if(o&&AlobotClient.argConfig&&AlobotClient.argConfig[o])return void t.empty()});var a=this.$elm.find("#alobot_chat_primeira_mensagem").parents(".alobot-form-group");a.before(o)},i.prototype.renderAguardando=function(t){t&&"--"!=t||(t=this._ultimoIndice||1),this._ultimoIndice=t,t<10&&(t="0"+t);var e="";e+='<div class="alobot-chat-container alobot-chat-no-input alobot-chat-indisponivel '+this.layoutClasse()+'">',e+=this.gerarTituloHTML(),e+=this.gerarHeaderHTML(),e+='<div class="alobot_aguardando-em-fila">',e+=a.t("posicao_fila",{indice:t}),e+="</div>",e+='<div class="alobot_aguardando_personalizacao">',e+=this.opts.templateAtendimentoAguardando,e+="</div>",e+='<div class="alobot_abandonar_atendimento_container">',e+="</div>",e+=this.gerarFooterGeralHTML(),e+="</div>",this.$elm.html(e),this.registrarEventos(),AlobotClient.Resizer.fixHeight()},i.prototype.renderAtendimento=function(){this.view="atendimento";var t="";t+='<div class="alobot-chat-container '+this.layoutClasse()+'">',t+=this.gerarTituloHTML({habilitarEncerrar:!0,online:!0}),t+=this.gerarHeaderHTML({habilitarEncerrar:!0,online:!0}),t+='<div class="alobot-chat-body alobot-chat-content-container atendimento" style="'+this.containerStyle()+'">',t+="</div>",t+=this.gerarInputHTML(),t+="</div>",this.$elm.html(t),this.registrarEventos(),this.adicionarIndicadorLoadingAntesPrimeiraMensagem(),AlobotClient.Resizer.fixHeight()},i.prototype.renderMensagem=function(t){this.removerOptionsCasoExista();for(var e=t.options||{},o=Object.keys(e),a=[],i=0;i<o.length;i++)o[i].indexOf("__")==-1&&a.push(o[i]);var n=a.length>0;t.id_usuario?n?this.renderOptions(t):this.renderMensagemOperador(t):t.id_contato?this.renderMensagemContato(t):this.renderStatus(t);var r=this.$elm.find(".alobot-chat-mensagem"),l=r[r.length-1];l?this.scrollChatBodyToElement(l):this.scrollChatBodyToBottom()},i.prototype.renderOperadorDigitandoFeedback=function(){this.$elm.find(".alobot-chat-body").find(".operador-digitando-feedback").remove();var t='<div class="operador-digitando-feedback">';t+=this.mensagemOperadorHTML({mensagem:"&nbsp;&nbsp;&nbsp;<i>"+a.t("operador_respondendo")+'</i> <img src="'+AlobotClient.url+'/img/lapiz.gif">&nbsp;&nbsp;&nbsp;',nome_envio:"",url_avatar:AlobotClient.url+"/img/white-square.jpg"}),t+="</div>",this.$elm.find(".alobot-chat-body").append(t),this.scrollChatBodyToBottom(),this.operadorRespondendoTimeout&&clearTimeout(this.operadorRespondendoTimeout);var e=this;this.operadorRespondendoTimeout=setTimeout(function(){e.removerOperadorDigitandoFeedback()},2e3)},i.prototype.renderStatus=function(t){t.nome_envio&&t.url_avatar?this.renderStatusComNomeEAvatar(t):this.renderStatusSimples(t)},i.prototype.renderStatusComNomeEAvatar=function(t){var e="";e+='<div class="alobot-chat-mensagem alobot-chat-mensagem-operador">',e+='<div class="alobot-chat-mensagem-avatar">',e+='<img src="'+t.url_avatar+'" class="avatar" />',e+="</div>",e+='<div class="alobot-chat-mensagem-texto">',e+='<div class="alobot-chat-mensagem-balao">',(t.nome_envio||t.created_at)&&(e+='<div class="alobot-chat-dados-envio"><b>'+t.nome_envio+"</b>&nbsp;"+o.horarioDaMensagem(t)+"</div>"),e+=t.mensagem,e+="</div>",e+="</div>",e+="</div>",this.$elm.find(".alobot-chat-body").append(e),this.scrollChatBodyToBottom()},i.prototype.renderStatusSimples=function(t){var e='<span style="color: green;">&#x2713;</span>';"error"==t.type&&(e='<span style="color: green;">&#x2713;</span>');var o="";o+='<div class="alobot-chat-status-container">',o+='<div class="alobot-chat-status">',o+='<span class="alobot-chat-status-mensagem">',o+=t.mensagem,o+="</span>",o+="</div>",o+="</div>",this.$elm.find(".alobot-chat-body").append(o),this.scrollChatBodyToBottom()},i.prototype.renderConfirmacaoEncerramento=function(){if(!AlobotJQuery(".alobot-chat-confirmacao-encerramento-container").length){this.desabilitarMensagemInput();var t=this,e=this.gerarAvaliacaoHTML({botaoEncerrar:!0});this.$elm.find(".alobot-chat-body").append(e),this.scrollChatBodyToBottom();var o=function(){t.$elm.find(".alobot-chat-confirmacao-encerramento-container").remove()};this.$elm.find(".alobot-button-confirmar-encerramento").bind("click",function(){var e=t.$elm.find(".aloweb_atendimento_feedback").val(),a="";e&&(a="feedback_contato="+encodeURIComponent(e)),t.emit("encerrar_atendimento",AlobotClient.cache("id_atendimento"),a),o(),t.habilitarMensagemInput()}),this.$elm.find(".continuar_atendimento").bind("click",function(){o(),t.habilitarMensagemInput()}),this.$elm.find(".alobot-chat-avaliacao-smile").on("click",function(){if(!t.avaliado){var e=AlobotJQuery(this).attr("data-value");t.$elm.find(".alobot-chat-avaliacao-smile").hide(),AlobotJQuery(this).show();var o="<div>Por favor, nos envie um comentário sobre o atendimento.</div>";e>1&&(o=""),t.$elm.find(".alobot-chat-confirmacao-encerramento-header").text(a.t("obrigado_por_avaliar")),t.$elm.find(".alobot-chat-confirmacao-texto").append(o),t.emit("avaliar",AlobotClient.cache("id_atendimento"),e),t.avaliado=!0,t.avaliacao=e}})}},i.prototype.adicionarFeedbackAposAvaliacao=function(){var t="<div>";t+='<textarea class="aloweb_atendimento_feedback" maxlength="500" placeholder="Escreva seu comentário"></textarea>',t+="</div>",this.$elm.find(".alobot-chat-avaliacao-container").html(t),this.$elm.find(".alobot-button-confirmar-encerramento").text(a.t("encerrar_atendimento_apos_avaliar"))},i.prototype.mostrarAvaliacaoAposEncerrado=function(){var t=AlobotJQuery(".alobot-chat-confirmacao-encerramento-container");if(t.length)return void t.remove();this.desabilitarMensagemInput();var e=this,o="";this.opts.templateAtendimentoEncerrado&&(o+=this.opts.templateAtendimentoEncerrado),o+=this.gerarAvaliacaoHTML({botaoEncerrar:!1}),o+='<div class="alobot-chat-acoes">';var i=null==AlobotClient.getConfig("btn_fechar");i&&(o+=this.gerarBotaoHTML("fechar_janela_atendimento",a.t("fechar"))),o+="</div>",this.$elm.find(".alobot-chat-body").append(o),this.scrollChatBodyToBottom();var n=function(){e.$elm.find(".alobot-chat-confirmacao-encerramento-container").remove()};this.$elm.find(".continuar_atendimento").bind("click",function(){
n()}),this.$elm.find(".alobot-chat-avaliacao-smile").on("click",function(){if(!e.avaliado){var t=AlobotJQuery(this).attr("data-value");e.$elm.find(".alobot-chat-avaliacao-smile").hide(),AlobotJQuery(this).show(),e.$elm.find(".alobot-chat-confirmacao-encerramento-header").text(a.t("obrigado_por_avaliar")),e.emit("avaliar",AlobotClient.cache("id_atendimento"),t),e.avaliado=!0,e.avaliacao=t}}),this.registrarEventos()},i.prototype.renderAcoesEncerrado=function(){var t="";this.opts.templateAtendimentoEncerrado&&(t+=this.opts.templateAtendimentoEncerrado),t+='<div class="alobot-chat-acoes">';var e=null==AlobotClient.getConfig("btn_fechar");e&&(t+=this.gerarBotaoHTML("fechar_janela_atendimento",a.t("fechar"))),t+="</div>",this.$elm.find(".alobot-chat-body").append(t),this.scrollChatBodyToBottom(),this.$elm.find(".alobot-chat-input-wrapper").find("*").remove(),this.atualizarLayoutParaFinalizado(),AlobotClient.Resizer.fixHeight()},i.prototype.renderBotaoAbandonarAtendimento=function(){var t=this.gerarBotaoHTML("abrir_mensagem_offline",a.t("abandonar_atendimento")),e=AlobotJQuery(t);e.find(".alobot-button").addClass("alobot-button-default"),this.$elm.find(".alobot_abandonar_atendimento_container").append(e),this.registrarEventos()},i.prototype.renderAvisoDepartamentosIndisponiveis=function(){var t="";t+='<div class="alobot-chat-container alobot-chat-no-input alobot-chat-identificacao">',t+=this.gerarTituloHTML(),t+=this.gerarHeaderHTML(),t+='<div class="alobot-chat-sucesso-mensagem-offline">',t+=document.location.href.indexOf("contmatic")!==-1&&AlobotClient.Configuracao.estaEmHorarioDeTrabalho()?"<div>OPS! Estamos com todos Operadores ocupados no momento. Só um instante que já estamos redirecionando você.</div>":this.opts.templateDepartamentosIndisponiveis,t+="</div>",t+=this.gerarFooterGeralHTML(),t+="</div>",this.$elm.html(t),this.registrarEventos(),AlobotClient.Resizer.fixHeight()},i.prototype.renderEnviarMensagemOffline=function(){if(this.emit("limpar_cache"),!o.mostrarFormularioMensagemOffline())return this.renderAvisoDepartamentosIndisponiveis();var t="";t+='<div class="alobot-chat-container alobot-chat-no-input alobot-chat-indisponivel">',t+=this.gerarTituloHTML(),t+=this.gerarHeaderHTML(),t+='<div class="alobot-chat-content-container">',t+='<div class="alobot-chat-enviar-mensagem-offline">',t+='<div class="alobot-form-group">',t+='<label class="alobot_label">'+a.t("envie_sua_mensagem_offline")+"</label>",t+='<textarea id="alobot_chat_mensagem_offline" class="alobot_form_textarea alobot_enviar_mensagem_offline_textarea" placeholder="'+a.t("mensagem_offline_placeholder")+'"></textarea>',t+="</div>",t+="</div>",t+="</div>",t+="</div>",t+='<div class="alobot-chat-enviar-mensagem-offline-botao-container">',t+=this.gerarBotaoHTML("enviar_mensagem_offline",a.t("enviar_mensagem_offline")),t+="</div>",t+=this.gerarFooterGeralHTML(),t+="</div>",this.$elm.html(t),this.registrarEventos(),AlobotClient.Resizer.fixHeight()},i.prototype.renderSucessoMensagemOffline=function(){var t="";t+='<div class="alobot-chat-container alobot-chat-no-input alobot-chat-mensagem-offline '+this.layoutClasse()+'">',t+=this.gerarTituloHTML(),t+=this.gerarHeaderHTML(),t+='<div class="alobot-chat-sucesso-mensagem-offline">',t+=this.opts.templateAtendimentoMensagemOffline,t+="</div>",t+=this.gerarFooterGeralHTML(),t+="</div>",this.$elm.html(t),this.registrarEventos(),AlobotClient.Resizer.fixHeight()},i.prototype.adicionarSubdepartamento=function(t){var e="";if(e+='<div class="alobot-form-group subdepartamento-container">',e+='<label for="alobot_chat_id_subdepartamento" class="alobot_label">'+a.t("sub_departamento")+"</label>",e+='<select id="alobot_chat_id_subdepartamento" class="alobot_form_input">',e+='<option value="">'+a.t("selecione")+"</option>",o.subdepartamentosDisponiveis(t).length>0)if(AlobotClient.getConfig("mostrarTodosDepartamentos"))var i=o.subdepartamentosComStatus(t);else var i=o.subdepartamentosDisponiveis(t);else{var i=o.subdepartamentosIndisponiveis(t);this.atualizarParaMensagemOffline()}for(var n=0;n<i.length;n++){var r=i[n];e+=AlobotClient.getConfig("mostrarTodosDepartamentos")?r.disponivel?'<option value="'+r.id+'">'+r.nome+"</option>":'<option value="'+r.id+'" style="background-color: #ffe4e0;">'+r.nome+"</option>":'<option value="'+r.id+'">'+r.nome+"</option>"}e+="</select>",e+="</div>";var l=this.$elm.find("#alobot_chat_id_departamento").parents(".alobot-form-group");1==l.length?l.after(e):(l=this.$elm.find(".alobot-iniciar-atendimento").prev(),l.before(e)),this.registrarEventos()},i.prototype.renderIndisponivel=function(){var t="";t+='<div class="alobot-chat-container alobot-chat-no-input">',t+=this.gerarTituloHTML(),t+=this.gerarHeaderHTML(),t+='<div class="alobot-chat-sucesso-mensagem-offline">',t+='<div style="text-align: center;">',t+=a.t("atendimento_encerrado_departamento_indisponivel"),t+="</div>",t+="</div>",t+='<div class="alobot-abandonar-atendimento-por-indisponibilidade-container">',t+=this.gerarBotaoHTML("ok_atendimento_encerrado_por_indisponibilidade",a.t("abandonar_atendimento")),t+="</div>",t+=this.gerarFooterGeralHTML(),t+="</div>",this.$elm.html(t),this.registrarEventos()},i.prototype.layoutClasse=function(){return"megatron"==this.opts.layout?"alobot-megatron":""},i.prototype.containerStyle=function(){return this.opts.bodyBg?"background-image: url('"+(AlobotClient.normalizarUrl(AlobotClient.url)+this.opts.bodyBg.trim())+"');":""},i.prototype.gerarAvaliacaoHTML=function(t){var e="";return e+='<div class="alobot-chat-confirmacao-encerramento-container">',e+='<div class="alobot-chat-confirmacao-encerramento">',e+='<div class="alobot-chat-confirmacao-texto">',e+=this.avaliado?'<p class="alobot-chat-confirmacao-encerramento-header">'+a.t("obrigado_por_avaliar")+"</p>":'<p class="alobot-chat-confirmacao-encerramento-header">'+a.t("como_voce_avalia_esse_chat")+"</p>",e+="</div>",e+='<div class="alobot-chat-continuar-atendimento continuar_atendimento">',e+='<i class="alobot-icon-encerrar-dark"></i>',e+="</div>",e+='<div class="alobot-chat-avaliacao-container">',this.avaliado?e+='<img class="alobot-chat-avaliacao-smile" data-value="'+this.avaliacao+'" src="'+AlobotClient.imagemAvaliacao(this.avaliacao)+'" />':(e+='<img class="alobot-chat-avaliacao-smile" title="Péssimo" data-value="-20" src="'+AlobotClient.imagemAvaliacao("-20")+'" />',e+='<img class="alobot-chat-avaliacao-smile" title="Ruim" data-value="-10" src="'+AlobotClient.imagemAvaliacao("-10")+'" />',e+='<img class="alobot-chat-avaliacao-smile" title="Neutro" data-value="1" src="'+AlobotClient.imagemAvaliacao("1")+'" />',e+='<img class="alobot-chat-avaliacao-smile" title="Bom" data-value="10" src="'+AlobotClient.imagemAvaliacao("10")+'" />',e+='<img class="alobot-chat-avaliacao-smile" title="Excelente" data-value="20" src="'+AlobotClient.imagemAvaliacao("20")+'" />'),e+="</div>",t.botaoEncerrar&&(e+='<div style=" padding-top: 5px; padding-bottom: 5px; ">',e+='<button class="alobot-button alobot-button-danger alobot-button-confirmar-encerramento">'+a.t("encerrar_atendimento")+"</button>",e+="</div>"),e+="</div>",e+="</div>"},i.prototype.iniciarSelectDepartamento=function(){if(AlobotClient.getConfig("id_departamento"))this.emit("select_departamento",AlobotClient.getConfig("id_departamento"));else if(AlobotClient.getConfig("mostrarTodosDepartamentos"))this.mostrarRootsComStatus();else{var t=o.departamentosRootsDisponiveis();if(t.length>0){var e=!AlobotClient.Configuracao.estaEmHorarioDeTrabalho();e?(this.mostrarRootsComStatus(),this.atualizarParaMensagemOffline()):this.mostrarRootsDisponiveis()}else this.mostrarRootsIndisponiveis()}},i.prototype.mostrarRootsDisponiveis=function(){var t=this.$elm.find("#alobot_chat_id_departamento");t.html(o.optionsDepartamentosRootsDisponiveis())},i.prototype.mostrarRootsIndisponiveis=function(){var t=this.$elm.find("#alobot_chat_id_departamento");t.html(o.optionsDepartamentosRootsIndisponiveis()),this.atualizarParaMensagemOffline()},i.prototype.mostrarRootsComStatus=function(){var t=this.$elm.find("#alobot_chat_id_departamento");t.html(o.optionsDepartamentosRootsComStatus())},i.prototype.gerarTituloHTML=function(t){if("megatron"==this.opts.layout)return"";t=t||{};var e="";e+=";background-color: "+this.opts.cor,e+=";border-color: "+AlobotClient.escurecerCor(this.opts.cor,-20),e+=";color: "+this.opts.tituloCor;var a="alobot-icon-minimizar-light";"#000"==this.opts.tituloCor&&(a="alobot-icon-minimizar-dark");var i="alobot-icon-encerrar-light";"#000"==this.opts.tituloCor&&(i="alobot-icon-encerrar-dark");var n="";n+='<div class="alobot-chat-titulo " style="'+e+'">';var r=t.online||o.disponivel();return n+=r?this.opts.titulo:this.opts.tituloOffline,n+='<div class="alobot-chat-titulo-actions">',AlobotClient.getConfig("fullscreen")||(n+='<div class="alobot-chat-titulo-action alobot-chat-titulo-minimizar minimizar"><i class="'+a+'"></i></div>'),t.habilitarEncerrar&&(n+='<div class="alobot-chat-titulo-action alobot-chat-titulo-encerrar encerrar"><i class="'+i+'"></i></div>'),n+="</div>",n+="</div>"},i.prototype.gerarHeaderHTML=function(t){if(t=t||{},"megatron"==this.opts.layout)return this.gerarHeaderHTMLMegatron(t);if("#FFF"==this.opts.tituloCor)var e=";color: "+this.opts.cor;var a=t.online||o.disponivel(),i="";i+='<table class="alobot-chat-header">',i+="<tr>",i+='<td class="alobot-chat-header-left">',i+='<div class="alobot-chat-header-avatar">';var n=a?this.opts.headerAvatarUrl:this.opts.headerAvatarUrlOffline;n=AlobotClient.cache("alobot_header_avatar")||n,i+='<img src="'+n+'" />',i+="</div>",i+="</td>",i+='<td class="alobot-chat-header-right">',i+='<div class="alobot-chat-header-nome" style="'+e+'">';var r=a?this.opts.headerNome:this.opts.headerNomeOffline;return i+=AlobotClient.cache("alobot_header_nome")||r,i+="</div>",i+='<div class="alobot-chat-header-assinatura">',i+=a?this.opts.headerAssinatura:this.opts.headerAssinaturaOffline,i+="</div>",i+="</td>",i+="<tr>",i+="</table>"},i.prototype.gerarHeaderHTMLMegatron=function(t){t=t||{};var e=t.online||o.disponivel(),a="";a+="; color: #fff;",a+=this.opts.bgGradiente;var i="alobot-icon-minimizar-light";"#000"==this.opts.tituloCor&&(i="alobot-icon-minimizar-dark");var n="alobot-icon-encerrar-light";"#000"==this.opts.tituloCor&&(n="alobot-icon-encerrar-dark");var r="";r+='<table class="alobot-chat-header" style="'+a+'">',r+="<tr>",r+='<td class="alobot-chat-header-title" colspan="2">';var e=t.online||o.disponivel();r+=this.opts.titulo,r+='<div class="alobot-chat-titulo-actions">',AlobotClient.getConfig("fullscreen")||(r+='<div class="alobot-chat-titulo-action alobot-chat-titulo-minimizar minimizar"><i class="'+i+'"></i></div>'),t.habilitarEncerrar&&(r+='<div class="alobot-chat-titulo-action alobot-chat-titulo-encerrar encerrar"><i class="'+n+'"></i></div>'),r+="</div>",r+="</td>",r+="</tr>",r+="<tr>",r+='<td class="alobot-chat-header-left">',r+='<div class="alobot-chat-header-avatar">';var l=e?this.opts.headerAvatarUrl:this.opts.headerAvatarUrlOffline;l=AlobotClient.cache("alobot_header_avatar")||l,r+='<img src="'+l+'" />',r+="</div>",r+="</td>",r+='<td class="alobot-chat-header-right">',r+='<div class="alobot-chat-header-nome">';var s=e?this.opts.headerNome:this.opts.headerNomeOffline;return r+=AlobotClient.cache("alobot_header_nome")||s,r+="</div>",r+='<div class="alobot-chat-header-assinatura">',r+=e?this.opts.headerAssinatura:this.opts.headerAssinaturaOffline,r+="</div>",r+="</td>",r+="</tr>",r+="</table>"},i.prototype.gerarIdentificacaoBodyHTML=function(){var t="";return t+='<div class="alobot-chat-body alobot-chat-content-container alobot-chat-identificacao-body" style="'+this.containerStyle()+'">',o.disponivel()?t+=this.opts.templateOnlineBoasVindas||"":this.opts.templateOfflineBoasVindas&&(t+=this.opts.templateOfflineBoasVindas),t+='<div style="height: 10px;"></div>',AlobotClient.getConfig("nome")?t+='<input type="hidden" class="alobot_form_input" id="alobot_chat_nome" value="'+AlobotClient.getConfig("nome")+'" />':(t+='<div class="alobot-form-group">',t+='<input type="text" class="alobot_form_input" id="alobot_chat_nome" value="" placeholder="'+a.t("nome")+'" />',t+="</div>"),AlobotClient.getConfig("email")?t+='<input type="hidden" class="alobot_form_input" id="alobot_chat_email" value="'+AlobotClient.getConfig("email")+'" />':(t+='<div class="alobot-form-group">',t+='<input type="text" class="alobot_form_input" id="alobot_chat_email" value="" placeholder="'+a.t("email")+'" />',t+="</div>"),AlobotClient.getConfig("id_departamento")?t+='<input type="hidden" id="alobot_chat_id_departamento" value="'+AlobotClient.getConfig("id_departamento")+'" />':(t+='<div class="alobot-form-group">',t+='<label class="alobot_label" for="alobot_chat_id_departamento">'+a.t("departamento")+"</label>",t+='<select id="alobot_chat_id_departamento" class="alobot_select alobot_form_input">',t+='<option value="">Selecione</option>',t+="</select>",t+="</div>"),!o.disponivel()&&o.iniciarAutoatendimento()?(t+='<div class="alobot-form-group">',t+='<input type="hidden" id="alobot_chat_primeira_mensagem" value="__" />',t+='<input type="hidden" name="id_bot" id="id_bot" value="'+this.opts.id_bot+'" data-campo-adicional="1" />',t+="</div>"):(t+='<div class="alobot-form-group">',t+=AlobotClient.getConfig("mensagem")?'<input type="hidden" id="alobot_chat_primeira_mensagem" class="alobot_form_textarea" value="'+AlobotClient.getConfig("mensagem")+'" />':'<textarea id="alobot_chat_primeira_mensagem" class="alobot_form_textarea" placeholder="'+a.t("primeira_mensagem")+'"></textarea>',t+="</div>"),t+="</div>",t+='<div class="alobot-iniciar-atendimento-botao-container">',t+=this.gerarBotaoHTML("enviar",a.t("iniciar_atendimento")),t+="</div>"},i.prototype.gerarBotaoHTML=function(t,e){var o="",a="";return a+=";background-color: "+this.opts.cor,a+=";color: "+this.opts.tituloCor,a+=";border: 1px solid "+AlobotClient.escurecerCor(this.opts.cor,-30),a+=";box-shadow: inset 0px 1px 0px rgba(255, 255, 255, 0.5)",o+='<div class="alobot-form-group">',o+='<button class="alobot-button" type="button" id="'+t+'" style="'+a+'">'+e+"</button>",o+="</div>"},i.prototype.gerarFooterGeralHTML=function(){var t="";t+="nome="+AlobotClient.cache("alobot_nome")+"&",t+="email="+AlobotClient.cache("alobot_email")+"&",t+="id_filial="+AlobotClient.opts.id_filial+"&",t+="token_filial="+AlobotClient.opts.token_filial+"&",t+="url_atual="+document.location.hostname+"&",t+="id_atendimento="+AlobotClient.cache("id_atendimento")+"&";var e="";return e+='<div class="alobot-chat-footer-geral">',e+='<a href="http://aloweb.com.br/conheca/'+document.location.hostname+'" style="text-decoration: none; color: #606060;" target="_blank">Powered by <img src="'+AlobotClient.url+'/img/aloweb_mini.png"> <b>aloweb</a></b>',e+="</div>"},i.prototype.adicionarIndicadorLoadingAntesPrimeiraMensagem=function(){this.desabilitarMensagemInput();var t="megatron"==this.opts.layout?"#aaa":this.opts.cor,e='<div class="alobot_loading_feedback">';e+='<svg width="80px" height="80px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-comments"> <path d="M78,19H22c-6.6,0-12,5.4-12,12v31c0,6.6,5.4,12,12,12h37.2c0.4,3,1.8,5.6,3.7,7.6c2.4,2.5,5.1,4.1,9.1,4 c-1.4-2.1-2-7.2-2-10.3c0-0.4,0-0.8,0-1.3h8c6.6,0,12-5.4,12-12V31C90,24.4,84.6,19,78,19z" ng-attr-fill="{{config.c1}}" fill="'+t+'"></path> <circle cx="30" cy="47" r="5" ng-attr-fill="{{config.c2}}" fill="#ffffff"> <animate attributeName="opacity" calcMode="linear" values="0;1;1" keyTimes="0;0.2;1" dur="1" begin="0s" repeatCount="indefinite"></animate> </circle> <circle cx="50" cy="47" r="5" ng-attr-fill="{{config.c3}}" fill="#ffffff"> <animate attributeName="opacity" calcMode="linear" values="0;0;1;1" keyTimes="0;0.2;0.4;1" dur="1" begin="0s" repeatCount="indefinite"></animate> </circle> <circle cx="70" cy="47" r="5" ng-attr-fill="{{config.c4}}" fill="#ffffff"> <animate attributeName="opacity" calcMode="linear" values="0;0;1;1" keyTimes="0;0.4;0.6;1" dur="1" begin="0s" repeatCount="indefinite"></animate> </circle> </svg>',e+='<div class="alobot_loading_feedback_carregando">Carregando...</div>',e+="</div>",this.$elm.find(".alobot-chat-body").append(e)},i.prototype.removerIndicadorLoadingAntesPrimeiraMensagem=function(){this.habilitarMensagemInput(),this.$elm.find(".alobot_loading_feedback").remove()},i.prototype.capturarValoresCamposAdicionais=function(t){var e=t._tipos||{},o=t.infos||{},a=this.$elm.find('*[data-campo-adicional="1"]');a.each(function(){var t=AlobotJQuery(this);o[t.prop("name")]=t.val(),e[t.prop("name")]=t.attr("data-tipo")});for(var i=AlobotClient.argConfig||{},n=Object.keys(i)||[],r=0;r<n.length;r++)o[n[r]]=i[n[r]];t.infos=o,t._tipos=e},i.prototype.mostrarErroValidacao=function(t,e){var o=this.$elm.find(t),a=o.parent().find("label");e&&o.parent().append('<div class="alobot_validacao_msg">'+e+"</div>"),a.addClass("alobot-has-error"),o.focus()},i.prototype.gerarInputHTML=function(){var t="";t+='<div class="alobot-chat-input-container">',t+='<div class="alobot-chat-input-disable"></div>',t+='<div class="alobot-chat-input-wrapper">',AlobotClient.suportaUploadDeArquivos()&&(t+=this.gerarUploadArquivoHTML()),t+='<a href="'+AlobotClient.url+"/chat/atendimentos/"+AlobotClient.cache("id_atendimento")+'/print" target="_blank" class="alobot-chat-imprimir">',t+='<i class="alobot-icon alobot-icon-print" title="Imprimir"></i>',t+="</a>",t+='<textarea placeholder="'+a.t("aperte_enter_para_enviar")+'" class="alobot-chat-input-textarea"></textarea>',t+="</div>",t+="</div>";var e="";return e+="nome="+AlobotClient.cache("alobot_nome")+"&",e+="email="+AlobotClient.cache("alobot_email")+"&",e+="id_filial="+AlobotClient.opts.id_filial+"&",e+="token_filial="+AlobotClient.opts.token_filial+"&",e+="url_atual="+document.location.hostname+"&",e+="id_atendimento="+AlobotClient.cache("id_atendimento")+"&",t+='<div class="alobot-chat-input-footer">',t+='<div class="alobot-chat-input-footer-right">',t+='<a href="http://aloweb.com.br/conheca/'+document.location.hostname+'" style="text-decoration: none; color: #606060;" target="_blank">Powered by <img src="'+AlobotClient.url+'/img/aloweb_mini.png"> <b>aloweb</a></b>',t+="</div>",t+="</div>"},i.prototype.gerarUploadArquivoHTML=function(){var t="";return t+='<form class="alobot-chat-input-arquivo" enctype="multipart/form-data" style="margin-bottom: 0;">',t+='<label class="alobot-icon alobot-icon-anexo" for="alobot_chat_anexo" title="'+a.t("upload_de_arquivos")+'"></label>',t+='<input type="file" id="alobot_chat_anexo" name="file" style="display: none;" />',t+="</form>"},i.prototype.mensagemOperadorHTML=function(t){"1"!=this.opts.mostrarNomeOperador&&(t.nome_envio=a.t("atendente"));var e="";return e+='<div class="alobot-chat-mensagem alobot-chat-mensagem-operador">',"1"==this.opts.mostrarAvatarOperador&&(e+='<div class="alobot-chat-mensagem-avatar">',e+='<img src="'+t.url_avatar+'" class="avatar" />',e+="</div>"),e+='<div class="alobot-chat-mensagem-texto">',e+='<div class="alobot-chat-mensagem-balao">',(t.nome_envio||t.created_at)&&(e+='<div class="alobot-chat-dados-envio"><b>'+t.nome_envio+"</b>&nbsp;"+o.horarioDaMensagem(t)+"</div>"),e+=t.mensagem,t.url_arquivo&&(e+='<a class="anexo-thumbnail" style="text-decoration: none;" href="'+t.url_arquivo+'" target="_blank"></a>'),e+="</div>",e+="</div>",e+="</div>"},i.prototype.removerOptionsCasoExista=function(){this.$optionsContainer&&(this.$optionsContainer.remove(),this.optionsContainer=null),AlobotClient.ChatAutocomplete.desabilitar(),AlobotClient.Resizer.fixHeight(),this.$elm.find(".alobot-option-for-autofaq").removeClass("alobot-option-for-autofaq"),this.$elm.find(".alobot-carregar-mais").parent().remove(),this.$elm.find(".alobot-nenhuma-dessas").parent().remove(),this.habilitarMensagemInput()},i.prototype.renderOptions=function(t){for(var e=t.options,o=Object.keys(e),a=[],i=0;i<o.length;i++)o[i].indexOf("__")==-1&&a.push(o[i]);var n=a.length,r=this;if(e.__layout&&"autofaq"==e.__layout)return delete e.__layout,this.renderOptionsForAutoFAQ(t);if(n>3){var l=this.$elm.find(".alobot-chat-input-textarea");AlobotClient.ChatAutocomplete.inicializar(this,l,e),AlobotClient.Resizer.fixHeight()}else{e.__input?delete e.__input:r.desabilitarMensagemInput();var s="";e.__hint&&(s=e.__hint,delete e.__hint);var c="";c+='<div class="alobot-chat-options-container">',c+='<div class="alobot-chat-options">';for(var d in t.options)c+='<div class="alobot-chat-option" data-value="'+d+'">'+t.options[d]+"</div>";s&&(c+='<div style="display: block; font-style: italic; font-size: 12px; margin-top: 5px;">'+s+"</div>"),c+="</div>",c+="</div>",this.$optionsContainer=AlobotJQuery(c),this.$optionsContainer.find(".alobot-chat-option").on("click",function(){r.habilitarMensagemInput();var t=this.getAttribute("data-value");r.emit("responder",t)}),this.$elm.find(".alobot-chat-body").append(this.$optionsContainer)}},i.prototype.renderOptionsForAutoFAQ=function(t){var e=t.options,o=this;o.desabilitarMensagemInput();var a="",i=1,n=0;e.__total?(n=e.__total,delete e.__total):i=4,a+="<div>Selecione uma das opções:</div>";for(var r in e)a+='<div class="alobot-option-for-autofaq" data-id="'+r+'" data-pergunta="'+t.options[r]+'"> &#x25B8; '+t.options[r]+"</div>";n>6?(a+='<div style="margin-top: 10px;">',a+='<a href="#" class="alobot-carregar-mais" style="text-decoration: none; color: #707070; fill: #707070; font-size: 12px;">',a+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="15" height="15" style="vertical-align: middle;"><path class="heroicon-ui" d="M4 15a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0-2a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm8 2a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0-2a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm8 2a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0-2a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/></svg>',a+=" Mostrar mais",a+="</a>",a+="</div>"):(a+='<div style="margin-top: 10px;">',a+='<a href="#" class="alobot-nenhuma-dessas" style="text-decoration: none; color: #707070; fill: #707070; font-size: 12px;">',a+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="15" height="15" style="vertical-align: middle;"><path class="heroicon-ui" d="M12 22a10 10 0 1 1 0-20 10 10 0 0 1 0 20zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm-3.54-4.54a5 5 0 0 1 7.08 0 1 1 0 0 1-1.42 1.42 3 3 0 0 0-4.24 0 1 1 0 0 1-1.42-1.42zM9 11a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm6 0a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/></svg>',a+=" Não encontrei",a+="</a>",a+="</div>"),t.mensagem=a;var l=this.renderMensagemOperador(t);l.find(".alobot-nenhuma-dessas").on("click",function(t){t.preventDefault(),o.emit("responder","Nenhuma dessas","not_found")}),l.find(".alobot-carregar-mais").on("click",function(t){t.preventDefault(),o.emit("responder","Mostrar mais","load_more")}),l.find(".alobot-option-for-autofaq").on("click",function(t){if(o.habilitarMensagemInput(),this.className.indexOf("alobot-option-for-autofaq")==-1)return void l.find(".alobot-option-for-autofaq").off("click");var e=this.getAttribute("data-pergunta"),a=this.getAttribute("data-id");o.emit("responder",e,a)})},i.prototype.renderMensagemOperador=function(e){var o=this.mensagemOperadorHTML(e),a=AlobotJQuery(o);return a.find(".alobot-chat-mensagem-balao img").each(function(){var t=AlobotJQuery(this).css("width");AlobotJQuery(this).css("max-width",t).css("width","100%")}),a.find(".anexo-thumbnail").each(function(){t.inicializarThumbnail(this,AlobotJQuery)}),this.$elm.find(".alobot-chat-body").append(a),this.removerOperadorDigitandoFeedback(),e.options&&e.options.__autofaq&&this.adicionarLikeDislikeEmMensagem(a,e),a},i.prototype.adicionarLikeDislikeEmMensagem=function(t,e){var o="";o+='<div class="alobot-autofaq-like-dislike">',o+='<span class="alobot-autofaq-like">',o+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path class="heroicon-ui" d="M17.62 10H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H8.5c-1.2 0-2.3-.72-2.74-1.79l-3.5-7-.03-.06A3 3 0 0 1 5 9h5V4c0-1.1.9-2 2-2h1.62l4 8zM16 11.24L12.38 4H12v7H5a1 1 0 0 0-.93 1.36l3.5 7.02a1 1 0 0 0 .93.62H16v-8.76zm2 .76v8h2v-8h-2z"/></svg>',o+="&nbsp;Gostei",o+="</span>",o+='<span class="alobot-autofaq-dislike">',o+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path class="heroicon-ui" d="M6.38 14H4a2 2 0 0 1-2-2V4c0-1.1.9-2 2-2h11.5c1.2 0 2.3.72 2.74 1.79l3.5 7 .03.06A3 3 0 0 1 19 15h-5v5a2 2 0 0 1-2 2h-1.62l-4-8zM8 12.76L11.62 20H12v-7h7c.13 0 .25-.02.38-.08a1 1 0 0 0 .55-1.28l-3.5-7.02A1 1 0 0 0 15.5 4H8v8.76zM6 12V4H4v8h2z"/></svg>',o+="&nbsp;Não gostei",o+="</span>",o+="</div>";var a=AlobotJQuery(o);a.find(".alobot-autofaq-like").on("click",function(){a.find(".alobot-autofaq-dislike").remove(),setTimeout(function(){a.remove()},1500),AlobotJQuery.post(AlobotClient.url+"/baseConhecimento/pesquisas_like_dislike",{pesquisa:e.options.__pesquisa,score:1,id_pergunta:e.options.__pergunta_id,id_atendimento:AlobotClient.cache("id_atendimento"),id_mensagem:e.id},function(t){})}),a.find(".alobot-autofaq-dislike").on("click",function(){a.find(".alobot-autofaq-like").remove(),setTimeout(function(){a.remove()},1500),AlobotJQuery.post(AlobotClient.url+"/baseConhecimento/pesquisas_like_dislike",{pesquisa:e.options.__pesquisa,score:-1,id_pergunta:e.options.__pergunta_id,id_atendimento:AlobotClient.cache("id_atendimento"),id_mensagem:e.id},function(t){})}),t.find(".alobot-chat-mensagem-balao").append(a)},i.prototype.removerMensagemTemporaria=function(t){var e=this.$elm.find(".alobot-chat-body"),o=e.find('.alobot-chat-mensagem[data-temporario="true"]');1==o.length?o.remove():o.each(function(){var e=AlobotJQuery(this),o=t.mensagem_original||t.mensagem,a=o.replace(/(\<br \/\>|&gt;|&lt;|[<>()\[\]])/g,"").trim(),i=e.find(".conteudo_mensagem").text().replace(/(\<br \/\>|&gt;|&lt;|[<>()\[\]])/g,"").trim();a==i&&e.remove()})},i.prototype.renderMensagemContato=function(t){this.removerMensagemTemporaria(t);var e="",a="";t.id||(a+='data-temporario="true"');var i="Você";"auto"!=t.nome_envio&&t.nome_envio&&(i=t.nome_envio),e+='<div class="alobot-chat-mensagem alobot-chat-mensagem-usuario" '+a+">",e+='<div class="alobot-chat-mensagem-texto" style="margin-right: 5px;">',e+='<div class="alobot-chat-mensagem-balao">',e+='<div class="alobot-chat-dados-envio"><b>'+i+"</b>&nbsp;"+o.horarioDaMensagem(t)+"</div>",e+='<span class="conteudo_mensagem">'+(t.mensagem_original||t.mensagem)+"</span>",t.url_arquivo&&(e+='<div style="overflow: auto;"><a href="'+t.url_arquivo+'" target="_blank"><i class="alobot-icon alobot-icon-file"></i>'+AlobotClient.extrairArquivoDaUrl(t.url_arquivo)+"</a></div>"),e+="</div>",e+="</div>","1"==this.opts.mostrarAvatarOperador&&(e+='<div class="alobot-chat-mensagem-avatar">',e+=t.id?'<img src="'+t.url_avatar+'" class="avatar" />':'<img src="'+AlobotClient.loadingGifUrl()+'" class="avatar" />',e+="</div>"),e+="</div>",this.removerOperadorDigitandoFeedback(),this.$elm.find(".alobot-chat-body").append(e)},i.prototype.scrollChatBodyToBottom=function(){var t=this.$elm.find(".alobot-chat-body");t.length&&t.scrollTop(t[0].scrollHeight)},i.prototype.scrollChatBodyToElement=function(t){this.$elm.find(".alobot-chat-body");t.scrollIntoView&&t.scrollIntoView()},i.prototype.removerOperadorDigitandoFeedback=function(){this.operadorRespondendoTimeout&&clearTimeout(this.operadorRespondendoTimeout),this.$elm.find(".alobot-chat-body").find(".operador-digitando-feedback").remove()},i.prototype.desabilitarMensagemInput=function(){var t=this.$elm.find(".alobot-chat-input-container");t.find(".alobot-chat-input-disable").show()},i.prototype.habilitarMensagemInput=function(){var t=this.$elm.find(".alobot-chat-input-container");t.find(".alobot-chat-input-disable").hide()},i.prototype.atualizarLayoutParaFinalizado=function(){this.$elm.find(".alobot-chat-container").addClass("finalizado")},i.prototype.atualizarHeader=function(t){this.$elm.find(".alobot-chat-header-avatar").find("img").attr("src",t.avatar),this.$elm.find(".alobot-chat-header-nome").text(t.nome)}}(window),function(t,e){var o=AlobotClient.ChatUtils,a=AlobotClient.I18n,i=AlobotClient.ChatDirectView=function(t,e){this.$elm=t,this.opts=e||{},AlobotEventEmitter.call(this)};i.prototype=Object.create(AlobotEventEmitter.prototype),i.prototype.renderIdentificacao=function(t){var e=this;o.mapaDepartamentos(function(a){o.possuiDepartamentoDisponivel(),o.forcarIndisponivel,AlobotClient.Configuracao.estaEmHorarioDeTrabalho();if(o.disponivel()){e.renderAtendimento();var i=AlobotClient.Trigger.mostrados;if(i.length>0)for(var n=0;n<i.length;n++)"mostrar_aviso"==i[n].acao_gatilho&&e.renderMensagem({id_usuario:1,mensagem:i[n].mensagem,url_avatar:i[n].avatar||e.opts.headerAvatarUrl});else e.opts.templateOnlineBoasVindas&&e.renderMensagem({id_usuario:1,mensagem:e.opts.templateOnlineBoasVindas,url_avatar:e.opts.headerAvatarUrl});return t()}if(!o.mostrarFormularioMensagemOffline())return e.renderAvisoDepartamentosIndisponiveis(),void(t&&t());var r="";r+='<div class="alobot-chat-container alobot-chat-no-input alobot-chat-identificacao">',r+=e.gerarTituloHTML(),r+=e.gerarHeaderHTML(),r+=e.gerarIdentificacaoBodyHTML(),r+=e.gerarFooterGeralHTML(),r+="</div>",e.$elm.html(r),e.registrarEventos(),e.iniciarSelectDepartamento(),AlobotClient.Resizer.fixHeight(),t&&t()})},i.prototype.registrarEventos=function(){if(!o.bloquearEventos){var t=(this.$elm.find(".alobot-chat-identificacao"),this),e=this.$elm.find(".alobot-chat-body");e.unbind("click"),e.find("#fechar_janela_atendimento").unbind("click").bind("click",function(){t.emit("limpar_cache"),t.emit("minimizar")}),this.$elm.find("#ok_atendimento_encerrado_por_indisponibilidade").off("click").on("click",function(){AlobotClient.cache("id_atendimento")&&(t.cacheIdAtendimento=AlobotClient.cache("id_atendimento")),t.emit("abandonar_atendimento")}),this.$elm.find(".minimizar").unbind("click").bind("click",function(){t.emit("minimizar")}),this.$elm.find(".encerrar").unbind("click").bind("click",function(){AlobotClient.estaEmAtendimento()?t.emit("pedido_encerramento"):t.emit("minimizar")}),this.$elm.find("#alobot_chat_id_departamento").unbind("change").bind("change",function(){var e=AlobotJQuery(this).val();t.emit("select_departamento",e)}),this.$elm.find("#alobot_chat_id_subdepartamento").unbind("change").bind("change",function(){var e=AlobotJQuery(this).val();t.emit("select_subdepartamento",e)}),this.$elm.find("#abrir_mensagem_offline").unbind("click").bind("click",function(){AlobotClient.cache("id_atendimento")&&(t.cacheIdAtendimento=AlobotClient.cache("id_atendimento")),t.emit("abandonar_atendimento")});var i=AlobotClient.cache("id_atendimento");this.$elm.find("#enviar_mensagem_offline").unbind("click").bind("click",function(){var e=t.$elm.find("#alobot_chat_mensagem_offline").val();t.emit("enviar_mensagem_offline",e,i||t.cacheIdAtendimento)});var n=this.$elm.find(".alobot-chat-input-container"),r=new Date,l=null;n.find(".alobot-chat-input-textarea").unbind("keydown keypress keyup").bind("keyup",function(e){var o=AlobotJQuery(this).val();if(l&&clearTimeout(l),13==e.which){if(""==o.trim())return;if(e.shiftKey)return;if(AlobotClient.estaEmAtendimento())t.emit("responder",o);else{var i={id_departamento:t.opts.layoutSemIdentificacaoIdDepartamento,nome:"",email:"",primeira_mensagem:o.trim(),token_identificador:AlobotClient.tokenIdentificador()};t.renderMensagemContato({id:1,id_contato:1,nome_envio:a.t("você"),mensagem:o.trim(),created_at:AlobotClient.dataAtualString(),url_avatar:AlobotClient.url+"/img/user_padrao.png"}),t.atendimentoIniciadoNessaSessao=!0,t.emit("iniciar_atendimento",i)}AlobotJQuery(this).val("")}else(new Date).getTime()-r.getTime()>2500?(t.emit("spy_text",o),r=new Date):l=setTimeout(function(){t.emit("spy_text",o)},2500)}),n.find(".alobot-chat-input-textarea").on("focus",function(){AlobotJQuery(this).css("border-color",t.opts.cor)}),n.find(".alobot-chat-input-textarea").on("blur",function(){AlobotJQuery(this).css("border-top-color","#DFDFDF"),AlobotJQuery(this).css("border-bottom-color","#DFDFDF"),AlobotJQuery(this).css("border-left-color","#A0A0A0"),AlobotJQuery(this).css("border-right-color","#A0A0A0");
}),n.find("#alobot_chat_anexo").unbind("change").bind("change",function(){var t=t=AlobotClient.url+"/chat/atendimentos/"+AlobotClient.cache("id_atendimento")+"/enviar_arquivo",e=AlobotJQuery(this).parents("form"),o=new FormData(e[0]);e.find("label").hide(),e.append('<i class="feedback alobot-icon-processando" style="margin-right: 3px;"></i>'),AlobotJQuery.ajax({type:"POST",url:t,data:o,processData:!1,contentType:!1,success:function(t){e.find(".feedback").remove(),e.find("label").show()},error:function(t){}})})}},i.prototype.renderErrorServidor=function(){var t="";t+='<div class="alobot-chat-container alobot-chat-no-input alobot-chat-mensagem-offline">',t+=this.gerarTituloHTML(),t+=this.gerarHeaderHTML(),t+='<div style="padding: 10px;">',t+=a.t("erro_no_servidor"),t+="</div>",t+=this.gerarFooterGeralHTML(),t+="</div>",this.$elm.html(t),this.registrarEventos()},i.prototype.removerCamposAdicionais=function(){this.$elm.find(".alobot-campo-adicional").remove()},i.prototype.removerSelectSubdepartamento=function(){this.$elm.find(".subdepartamento-container").remove()},i.prototype.atualizarParaMensagemOnline=function(){this.$elm.find("#enviar").html(a.t("iniciar_atendimento"))},i.prototype.atualizarParaMensagemOffline=function(){this.$elm.find("#enviar").html(a.t("enviar_mensagem_offline"))},i.prototype.renderizarCamposAdicionais=function(t){var e=AlobotJQuery(t);e.find(".form-group").addClass("alobot-form-group alobot-campo-adicional").removeClass("form-group"),e.find(".form-control").addClass("alobot_form_input").removeClass("form-control"),e.find("label").addClass("alobot_label");var o=e.find(".alobot-form-group");o.each(function(){var t=AlobotJQuery(this),e=AlobotJQuery(this).find("input,select,textarea");e.attr("data-campo-adicional","1"),e.remove();t.append(e);var o=e.attr("id");if(o&&AlobotClient.argConfig&&AlobotClient.argConfig[o])return void t.empty()});var a=this.$elm.find("#alobot_chat_primeira_mensagem").parents(".alobot-form-group");a.before(o)},i.prototype.renderAguardando=function(t){var e=null;e=AlobotClient.Trigger.mostrados.length>0?AlobotClient.Trigger.mostrados[0].avatar||this.opts.headerAvatarUrl:this.opts.headerAvatarUrl,this.atendimentoIniciadoNessaSessao?this.renderMensagem({id_usuario:1,mensagem:a.t("mensagem_aguarde_para_ser_atendido")||"Por favor, aguarde para ser atendido.",url_avatar:e}):(this.renderAtendimento(),this.renderMensagem({id_usuario:1,mensagem:a.t("mensagem_aguarde_para_ser_atendido")||"Por favor, aguarde para ser atendido.",url_avatar:e}))},i.prototype.renderAtendimento=function(){if("atendimento"!=this.view){this.view="atendimento";var t="";t+='<div class="alobot-chat-container '+this.layoutClasse()+'">',t+=this.gerarTituloHTML({habilitarEncerrar:!0,online:!0}),t+=this.gerarHeaderHTML({habilitarEncerrar:!0,online:!0}),t+='<div class="alobot-chat-body alobot-chat-content-container atendimento" style="'+this.containerStyle()+'">',t+="</div>",t+=this.gerarInputHTML(),t+="</div>",this.$elm.html(t),this.registrarEventos(),AlobotClient.Resizer.fixHeight()}},i.prototype.renderMensagem=function(t){this.removerOptionsCasoExista(),t.id_usuario?this.renderMensagemOperador(t):t.id_contato?this.renderMensagemContato(t):this.renderStatus(t),this.scrollChatBodyToBottom()},i.prototype.renderOperadorDigitandoFeedback=function(){this.$elm.find(".alobot-chat-body").find(".operador-digitando-feedback").remove();var t='<div class="operador-digitando-feedback">';t+=this.mensagemOperadorHTML({mensagem:"&nbsp;&nbsp;&nbsp;<i>"+a.t("operador_respondendo")+"</i>&nbsp;&nbsp;&nbsp;",nome_envio:"",url_avatar:"http://duncanflynn.com/wp-content/uploads/2014/11/white-square.jpg"}),t+="</div>",this.$elm.find(".alobot-chat-body").append(t),this.scrollChatBodyToBottom(),this.operadorRespondendoTimeout&&clearTimeout(this.operadorRespondendoTimeout);var e=this;this.operadorRespondendoTimeout=setTimeout(function(){e.removerOperadorDigitandoFeedback()},2e3)},i.prototype.renderStatus=function(t){t.nome_envio&&t.url_avatar?this.renderStatusComNomeEAvatar(t):this.renderStatusSimples(t)},i.prototype.renderStatusComNomeEAvatar=function(t){if(3!=t.tipo){var e="";e+='<div class="alobot-chat-mensagem alobot-chat-mensagem-operador">',e+='<div class="alobot-chat-mensagem-avatar">',e+='<img src="'+t.url_avatar+'" class="avatar" />',e+="</div>",e+='<div class="alobot-chat-mensagem-texto">',e+='<div class="alobot-chat-mensagem-balao">',(t.nome_envio||t.created_at)&&(e+='<div class="alobot-chat-dados-envio"><b>'+t.nome_envio+"</b>&nbsp;"+o.horarioDaMensagem(t)+"</div>"),e+=t.mensagem,e+="</div>",e+="</div>",e+="</div>",this.$elm.find(".alobot-chat-body").append(e),this.scrollChatBodyToBottom()}else if(this.atendimentoIniciadoNessaSessao)return this.renderStatus({mensagem:"atendimento iniciado"})},i.prototype.renderStatusSimples=function(t){var e='<span style="color: green;">&#x2713;</span>';"error"==t.type&&(e='<span style="color: green;">&#x2713;</span>');var o="";o+='<div class="alobot-chat-status-container">',o+='<div class="alobot-chat-status">',o+='<span class="alobot-chat-status-mensagem">',o+=t.mensagem,o+="</span>",o+="</div>",o+="</div>",this.$elm.find(".alobot-chat-body").append(o),this.scrollChatBodyToBottom()},i.prototype.renderConfirmacaoEncerramento=function(){if(!AlobotJQuery(".alobot-chat-confirmacao-encerramento-container").length){this.desabilitarMensagemInput();var t=this,e=this.gerarAvaliacaoHTML({botaoEncerrar:!0});this.$elm.find(".alobot-chat-body").append(e),this.scrollChatBodyToBottom();var o=function(){t.$elm.find(".alobot-chat-confirmacao-encerramento-container").remove()};this.$elm.find(".alobot-button-confirmar-encerramento").bind("click",function(){t.emit("encerrar_atendimento",AlobotClient.cache("id_atendimento")),o(),t.habilitarMensagemInput()}),this.$elm.find(".continuar_atendimento").bind("click",function(){o(),t.habilitarMensagemInput()}),this.$elm.find(".alobot-chat-avaliacao-smile").on("click",function(){if(!t.avaliado){var e=AlobotJQuery(this).attr("data-value");t.$elm.find(".alobot-chat-avaliacao-smile").hide(),AlobotJQuery(this).show(),t.$elm.find(".alobot-chat-confirmacao-encerramento-header").text(a.t("obrigado_por_avaliar")),t.emit("avaliar",AlobotClient.cache("id_atendimento"),e),t.avaliado=!0,t.avaliacao=e}})}},i.prototype.mostrarAvaliacaoAposEncerrado=function(){var t=AlobotJQuery(".alobot-chat-confirmacao-encerramento-container");if(t.length)return void t.remove();this.desabilitarMensagemInput();var e=this,o="";this.opts.templateAtendimentoEncerrado&&(o+=this.opts.templateAtendimentoEncerrado),o+=this.gerarAvaliacaoHTML({botaoEncerrar:!1}),o+='<div class="alobot-chat-acoes">',o+=this.gerarBotaoHTML("fechar_janela_atendimento",a.t("fechar")),o+="</div>",this.$elm.find(".alobot-chat-body").append(o),this.scrollChatBodyToBottom();var i=function(){e.$elm.find(".alobot-chat-confirmacao-encerramento-container").remove()};this.$elm.find(".continuar_atendimento").bind("click",function(){i()}),this.$elm.find(".alobot-chat-avaliacao-smile").on("click",function(){if(!e.avaliado){var t=AlobotJQuery(this).attr("data-value");e.$elm.find(".alobot-chat-avaliacao-smile").hide(),AlobotJQuery(this).show(),e.$elm.find(".alobot-chat-confirmacao-encerramento-header").text(a.t("obrigado_por_avaliar")),e.emit("avaliar",AlobotClient.cache("id_atendimento"),t),e.avaliado=!0,e.avaliacao=t}}),this.registrarEventos()},i.prototype.renderAcoesEncerrado=function(){var t="";this.opts.templateAtendimentoEncerrado&&(t+=this.opts.templateAtendimentoEncerrado),t+='<div class="alobot-chat-acoes">',t+=this.gerarBotaoHTML("fechar_janela_atendimento",a.t("fechar")),t+="</div>",this.$elm.find(".alobot-chat-body").append(t),this.scrollChatBodyToBottom(),this.$elm.find(".alobot-chat-input-wrapper").find("*").remove(),this.atualizarLayoutParaFinalizado(),AlobotClient.Resizer.fixHeight()},i.prototype.renderBotaoAbandonarAtendimento=function(){var t=this.gerarBotaoHTML("abrir_mensagem_offline",a.t("abandonar_atendimento")),e=AlobotJQuery(t);e.find(".alobot-button").addClass("alobot-button-default"),this.$elm.find(".alobot_abandonar_atendimento_container").append(e),this.registrarEventos()},i.prototype.renderAvisoDepartamentosIndisponiveis=function(){var t="";t+='<div class="alobot-chat-container alobot-chat-no-input alobot-chat-identificacao">',t+=this.gerarTituloHTML(),t+=this.gerarHeaderHTML(),t+='<div class="alobot-chat-sucesso-mensagem-offline">',t+=this.opts.templateDepartamentosIndisponiveis,t+="</div>",t+=this.gerarFooterGeralHTML(),t+="</div>",this.$elm.html(t),this.registrarEventos(),AlobotClient.Resizer.fixHeight()},i.prototype.renderEnviarMensagemOffline=function(){if(this.emit("limpar_cache"),!o.mostrarFormularioMensagemOffline())return this.renderAvisoDepartamentosIndisponiveis();var t="";t+='<div class="alobot-chat-container alobot-chat-no-input alobot-chat-indisponivel">',t+=this.gerarTituloHTML(),t+=this.gerarHeaderHTML(),t+='<div class="alobot-chat-content-container">',t+='<div class="alobot-chat-enviar-mensagem-offline">',t+='<div class="alobot-form-group">',t+='<label class="alobot_label">'+a.t("envie_sua_mensagem_offline")+"</label>",t+='<textarea id="alobot_chat_mensagem_offline" class="alobot_form_textarea alobot_enviar_mensagem_offline_textarea" placeholder="'+a.t("mensagem_offline_placeholder")+'"></textarea>',t+="</div>",t+="</div>",t+="</div>",t+="</div>",t+='<div class="alobot-chat-enviar-mensagem-offline-botao-container">',t+=this.gerarBotaoHTML("enviar_mensagem_offline",a.t("enviar_mensagem_offline")),t+="</div>",t+=this.gerarFooterGeralHTML(),t+="</div>",this.$elm.html(t),this.registrarEventos(),AlobotClient.Resizer.fixHeight()},i.prototype.renderSucessoMensagemOffline=function(){var t="";t+='<div class="alobot-chat-container alobot-chat-no-input alobot-chat-mensagem-offline">',t+=this.gerarTituloHTML(),t+=this.gerarHeaderHTML(),t+='<div class="alobot-chat-sucesso-mensagem-offline">',t+=this.opts.templateAtendimentoMensagemOffline,t+="</div>",t+=this.gerarFooterGeralHTML(),t+="</div>",this.$elm.html(t),this.registrarEventos(),AlobotClient.Resizer.fixHeight()},i.prototype.adicionarSubdepartamento=function(t){var e="";if(e+='<div class="alobot-form-group subdepartamento-container">',e+='<label for="alobot_chat_id_subdepartamento" class="alobot_label">'+a.t("sub_departamento")+"</label>",e+='<select id="alobot_chat_id_subdepartamento" class="alobot_form_input">',e+='<option value="">'+a.t("selecione")+"</option>",o.subdepartamentosDisponiveis(t).length>0)if(AlobotClient.getConfig("mostrarTodosDepartamentos"))var i=o.subdepartamentosComStatus(t);else var i=o.subdepartamentosDisponiveis(t);else{var i=o.subdepartamentosIndisponiveis(t);this.atualizarParaMensagemOffline()}i.forEach(function(t){e+=AlobotClient.getConfig("mostrarTodosDepartamentos")?t.disponivel?'<option value="'+t.id+'">'+t.nome+"</option>":'<option value="'+t.id+'" style="background-color: #ffe4e0;">'+t.nome+"</option>":'<option value="'+t.id+'">'+t.nome+"</option>"}),e+="</select>",e+="</div>";var n=this.$elm.find("#alobot_chat_id_departamento").parents(".alobot-form-group");1==n.length?n.after(e):(n=this.$elm.find(".alobot-iniciar-atendimento").prev(),n.before(e)),this.registrarEventos()},i.prototype.renderIndisponivel=function(){var t="";t+='<div class="alobot-chat-container alobot-chat-no-input">',t+=this.gerarTituloHTML(),t+=this.gerarHeaderHTML(),t+='<div class="alobot-chat-sucesso-mensagem-offline">',t+='<div style="text-align: center;">',t+=a.t("atendimento_encerrado_departamento_indisponivel"),t+="</div>",t+="</div>",t+='<div class="alobot-abandonar-atendimento-por-indisponibilidade-container">',t+=this.gerarBotaoHTML("ok_atendimento_encerrado_por_indisponibilidade",a.t("abandonar_atendimento")),t+="</div>",t+=this.gerarFooterGeralHTML(),t+="</div>",this.$elm.html(t),this.registrarEventos()},i.prototype.layoutClasse=function(){return"megatron"==this.opts.layout?"alobot-megatron":""},i.prototype.containerStyle=function(){return this.opts.bodyBg?"background-image: url('"+(AlobotClient.normalizarUrl(AlobotClient.url)+this.opts.bodyBg.trim())+"');":""},i.prototype.gerarAvaliacaoHTML=function(t){var e="";return e+='<div class="alobot-chat-confirmacao-encerramento-container">',e+='<div class="alobot-chat-confirmacao-encerramento">',e+=this.avaliado?'<p class="alobot-chat-confirmacao-encerramento-header">'+a.t("obrigado_por_avaliar")+"</p>":'<p class="alobot-chat-confirmacao-encerramento-header">'+a.t("como_voce_avalia_esse_chat")+"</p>",e+='<div class="alobot-chat-continuar-atendimento continuar_atendimento">',e+='<i class="alobot-icon-encerrar-dark"></i>',e+="</div>",e+='<div class="alobot-chat-avaliacao-container">',this.avaliado?e+='<img class="alobot-chat-avaliacao-smile" data-value="'+this.avaliacao+'" src="'+AlobotClient.imagemAvaliacao(this.avaliacao)+'" />':(e+='<img class="alobot-chat-avaliacao-smile" title="Péssimo" data-value="-20" src="'+AlobotClient.imagemAvaliacao("-20")+'" />',e+='<img class="alobot-chat-avaliacao-smile" title="Ruim" data-value="-10" src="'+AlobotClient.imagemAvaliacao("-10")+'" />',e+='<img class="alobot-chat-avaliacao-smile" title="Neutro" data-value="1" src="'+AlobotClient.imagemAvaliacao("1")+'" />',e+='<img class="alobot-chat-avaliacao-smile" title="Bom" data-value="10" src="'+AlobotClient.imagemAvaliacao("10")+'" />',e+='<img class="alobot-chat-avaliacao-smile" title="Excelente" data-value="20" src="'+AlobotClient.imagemAvaliacao("20")+'" />'),e+="</div>",t.botaoEncerrar&&(e+='<button class="alobot-button alobot-button-danger alobot-button-confirmar-encerramento">'+a.t("encerrar_atendimento")+"</button>"),e+="</div>",e+="</div>"},i.prototype.iniciarSelectDepartamento=function(){if(AlobotClient.getConfig("id_departamento"))this.emit("select_departamento",AlobotClient.getConfig("id_departamento"));else if(AlobotClient.getConfig("mostrarTodosDepartamentos"))this.mostrarRootsComStatus();else{var t=o.departamentosRootsDisponiveis();if(t.length>0){var e=!AlobotClient.Configuracao.estaEmHorarioDeTrabalho();e?(this.mostrarRootsComStatus(),this.atualizarParaMensagemOffline()):this.mostrarRootsDisponiveis()}else this.mostrarRootsIndisponiveis()}},i.prototype.mostrarRootsDisponiveis=function(){var t=this.$elm.find("#alobot_chat_id_departamento");t.html(o.optionsDepartamentosRootsDisponiveis())},i.prototype.mostrarRootsIndisponiveis=function(){var t=this.$elm.find("#alobot_chat_id_departamento");t.html(o.optionsDepartamentosRootsIndisponiveis()),this.atualizarParaMensagemOffline()},i.prototype.mostrarRootsComStatus=function(){var t=this.$elm.find("#alobot_chat_id_departamento");t.html(o.optionsDepartamentosRootsComStatus())},i.prototype.gerarTituloHTML=function(t){if("megatron"==this.opts.layout)return"";t=t||{};var e="";e+=";background-color: "+this.opts.cor,e+=";border-color: "+AlobotClient.escurecerCor(this.opts.cor,-20),e+=";color: "+this.opts.tituloCor;var a="alobot-icon-minimizar-light";"#000"==this.opts.tituloCor&&(a="alobot-icon-minimizar-dark");var i="alobot-icon-encerrar-light";"#000"==this.opts.tituloCor&&(i="alobot-icon-encerrar-dark");var n="";n+='<div class="alobot-chat-titulo " style="'+e+'">';var r=t.online||o.disponivel();return n+=r?this.opts.titulo:this.opts.tituloOffline,n+='<div class="alobot-chat-titulo-actions">',AlobotClient.getConfig("fullscreen")||(n+='<div class="alobot-chat-titulo-action alobot-chat-titulo-minimizar minimizar"><i class="'+a+'"></i></div>'),t.habilitarEncerrar&&(n+='<div class="alobot-chat-titulo-action alobot-chat-titulo-encerrar encerrar"><i class="'+i+'"></i></div>'),n+="</div>",n+="</div>"},i.prototype.gerarHeaderHTML=function(t){if(t=t||{},"megatron"==this.opts.layout)return this.gerarHeaderHTMLMegatron(t);if("#FFF"==this.opts.tituloCor)var e=";color: "+this.opts.cor;var a=t.online||o.disponivel(),i="";i+='<table class="alobot-chat-header">',i+="<tr>",i+='<td class="alobot-chat-header-left">',i+='<div class="alobot-chat-header-avatar">';var n=a?this.opts.headerAvatarUrl:this.opts.headerAvatarUrlOffline;n=AlobotClient.cache("alobot_header_avatar")||n,i+='<img src="'+n+'" />',i+="</div>",i+="</td>",i+='<td class="alobot-chat-header-right">',i+='<div class="alobot-chat-header-nome" style="'+e+'">';var r=a?this.opts.headerNome:this.opts.headerNomeOffline;return i+=AlobotClient.cache("alobot_header_nome")||r,i+="</div>",i+='<div class="alobot-chat-header-assinatura">',i+=a?this.opts.headerAssinatura:this.opts.headerAssinaturaOffline,i+="</div>",i+="</td>",i+="<tr>",i+="</table>"},i.prototype.gerarHeaderHTMLMegatron=function(t){t=t||{};var e=t.online||o.disponivel(),a="";a+="; color: #fff;",a+=this.opts.bgGradiente;var i="alobot-icon-minimizar-light";"#000"==this.opts.tituloCor&&(i="alobot-icon-minimizar-dark");var n="alobot-icon-encerrar-light";"#000"==this.opts.tituloCor&&(n="alobot-icon-encerrar-dark");var r="";r+='<table class="alobot-chat-header" style="'+a+'">',r+="<tr>",r+='<td class="alobot-chat-header-title" colspan="2">';var e=t.online||o.disponivel();r+=this.opts.titulo,r+='<div class="alobot-chat-titulo-actions">',AlobotClient.getConfig("fullscreen")||(r+='<div class="alobot-chat-titulo-action alobot-chat-titulo-minimizar minimizar"><i class="'+i+'"></i></div>'),t.habilitarEncerrar&&(r+='<div class="alobot-chat-titulo-action alobot-chat-titulo-encerrar encerrar"><i class="'+n+'"></i></div>'),r+="</div>",r+="</td>",r+="</tr>",r+="<tr>",r+='<td class="alobot-chat-header-left">',r+='<div class="alobot-chat-header-avatar">';var l=e?this.opts.headerAvatarUrl:this.opts.headerAvatarUrlOffline;l=AlobotClient.cache("alobot_header_avatar")||l,r+='<img src="'+l+'" />',r+="</div>",r+="</td>",r+='<td class="alobot-chat-header-right">',r+='<div class="alobot-chat-header-nome">';var s=e?this.opts.headerNome:this.opts.headerNomeOffline;return r+=AlobotClient.cache("alobot_header_nome")||s,r+="</div>",r+='<div class="alobot-chat-header-assinatura">',r+=e?this.opts.headerAssinatura:this.opts.headerAssinaturaOffline,r+="</div>",r+="</td>",r+="</tr>",r+="</table>"},i.prototype.gerarIdentificacaoBodyHTML=function(){var t="";return t+='<div class="alobot-chat-body alobot-chat-content-container alobot-chat-identificacao-body">',this.opts.templateOnlineBoasVindas&&o.disponivel()?t+=this.opts.templateOnlineBoasVindas:this.opts.templateOfflineBoasVindas&&(t+=this.opts.templateOfflineBoasVindas),t+='<div style="height: 10px;"></div>',AlobotClient.getConfig("nome")?t+='<input type="hidden" class="alobot_form_input" id="alobot_chat_nome" value="'+AlobotClient.getConfig("nome")+'" />':(t+='<div class="alobot-form-group">',t+='<input type="text" class="alobot_form_input" id="alobot_chat_nome" value="" placeholder="'+a.t("nome")+'" />',t+="</div>"),AlobotClient.getConfig("email")?t+='<input type="hidden" class="alobot_form_input" id="alobot_chat_email" value="'+AlobotClient.getConfig("email")+'" />':(t+='<div class="alobot-form-group">',t+='<input type="text" class="alobot_form_input" id="alobot_chat_email" value="" placeholder="'+a.t("email")+'" />',t+="</div>"),AlobotClient.getConfig("id_departamento")?t+='<input type="hidden" id="alobot_chat_id_departamento" value="'+AlobotClient.getConfig("id_departamento")+'" />':(t+='<div class="alobot-form-group">',t+='<label class="alobot_label" for="alobot_chat_id_departamento">'+a.t("departamento")+"</label>",t+='<select id="alobot_chat_id_departamento" class="alobot_select alobot_form_input">',t+='<option value="">Selecione</option>',t+="</select>",t+="</div>"),t+='<div class="alobot-form-group">',t+=AlobotClient.getConfig("mensagem")?'<input type="hidden" id="alobot_chat_primeira_mensagem" class="alobot_form_textarea" value="'+AlobotClient.getConfig("mensagem")+'" />':'<textarea id="alobot_chat_primeira_mensagem" class="alobot_form_textarea" placeholder="'+a.t("primeira_mensagem")+'"></textarea>',t+="</div>",t+="</div>",t+='<div class="alobot-iniciar-atendimento-botao-container">',t+=this.gerarBotaoHTML("enviar",a.t("iniciar_atendimento")),t+="</div>"},i.prototype.gerarBotaoHTML=function(t,e){var o="",a="";return a+=";background-color: "+this.opts.cor,a+=";color: "+this.opts.tituloCor,a+=";border: 1px solid "+AlobotClient.escurecerCor(this.opts.cor,-30),a+=";box-shadow: inset 0px 1px 0px rgba(255, 255, 255, 0.5)",o+='<div class="alobot-form-group">',o+='<button class="alobot-button" type="button" id="'+t+'" style="'+a+'">'+e+"</button>",o+="</div>"},i.prototype.gerarFooterGeralHTML=function(){var t="";t+="nome="+AlobotClient.cache("alobot_nome")+"&",t+="email="+AlobotClient.cache("alobot_email")+"&",t+="id_filial="+AlobotClient.opts.id_filial+"&",t+="token_filial="+AlobotClient.opts.token_filial+"&",t+="url_atual="+document.location.hostname+"&",t+="id_atendimento="+AlobotClient.cache("id_atendimento")+"&";var e="";return e+='<div class="alobot-chat-footer-geral">',e+='<a href="http://aloweb.com.br/conheca/'+document.location.hostname+'" style="text-decoration: none; color: #606060;" target="_blank">Powered by <img src="'+AlobotClient.url+"/img/logo.php?"+t+'"> <b>aloweb</a></b>',e+="</div>"},i.prototype.capturarValoresCamposAdicionais=function(t){var e=t._tipos||{},o=t.infos||{},a=this.$elm.find('*[data-campo-adicional="1"]');a.each(function(){var t=AlobotJQuery(this);o[t.prop("name")]=t.val(),e[t.prop("name")]=t.attr("data-tipo")});for(var i=AlobotClient.argConfig||{},n=Object.keys(i)||[],r=0;r<n.length;r++)o[n[r]]=i[n[r]];t.infos=o,t._tipos=e},i.prototype.mostrarErroValidacao=function(t){var e=this.$elm.find(t),o=e.parent().find("label");o.addClass("alobot-has-error"),e.focus()},i.prototype.gerarInputHTML=function(){var t="";t+='<div class="alobot-chat-input-container">',t+='<div class="alobot-chat-input-disable"></div>',t+='<div class="alobot-chat-input-wrapper">',AlobotClient.suportaUploadDeArquivos()&&(t+=this.gerarUploadArquivoHTML()),t+='<a href="'+AlobotClient.url+"/chat/atendimentos/"+AlobotClient.cache("id_atendimento")+'/print" target="_blank" class="alobot-chat-imprimir">',t+='<i class="alobot-icon alobot-icon-print" title="Imprimir"></i>',t+="</a>",t+='<textarea placeholder="'+a.t("aperte_enter_para_enviar")+'" class="alobot-chat-input-textarea"></textarea>',t+="</div>",t+="</div>";var e="";return e+="nome="+AlobotClient.cache("alobot_nome")+"&",e+="email="+AlobotClient.cache("alobot_email")+"&",e+="id_filial="+AlobotClient.opts.id_filial+"&",e+="token_filial="+AlobotClient.opts.token_filial+"&",e+="url_atual="+document.location.hostname+"&",e+="id_atendimento="+AlobotClient.cache("id_atendimento")+"&",t+='<div class="alobot-chat-input-footer">',t+='<div class="alobot-chat-input-footer-right">',t+='<a href="http://aloweb.com.br/conheca/'+document.location.hostname+'" style="text-decoration: none; color: #606060;" target="_blank">Powered by <img src="'+AlobotClient.url+"/img/logo.php?"+e+'"> <b>aloweb</a></b>',t+="</div>",t+="</div>"},i.prototype.gerarUploadArquivoHTML=function(){var t="";return t+='<form class="alobot-chat-input-arquivo" enctype="multipart/form-data" style="margin-bottom: 0;">',t+='<label class="alobot-icon alobot-icon-anexo" for="alobot_chat_anexo" title="'+a.t("upload_de_arquivos")+'"></label>',t+='<input type="file" id="alobot_chat_anexo" name="file" style="display: none;" />',t+="</form>"},i.prototype.mensagemOperadorHTML=function(t){"1"!=this.opts.mostrarNomeOperador&&(t.nome_envio=a.t("atendente"));var e="";return e+='<div class="alobot-chat-mensagem alobot-chat-mensagem-operador">',"1"==this.opts.mostrarAvatarOperador&&(e+='<div class="alobot-chat-mensagem-avatar">',e+='<img src="'+t.url_avatar+'" class="avatar" />',e+="</div>"),e+='<div class="alobot-chat-mensagem-texto">',e+='<div class="alobot-chat-mensagem-balao">',(t.nome_envio||t.created_at)&&(e+='<div class="alobot-chat-dados-envio"><b>'+t.nome_envio+"</b>&nbsp;"+o.horarioDaMensagem(t)+"</div>"),e+=t.mensagem,t.url_arquivo&&(e+='<div style="overflow: auto;"><a href="'+t.url_arquivo+'" target="_blank"><i class="alobot-icon alobot-icon-file"></i>'+AlobotClient.extrairArquivoDaUrl(t.url_arquivo)+"</a></div>"),e+="</div>",e+="</div>",e+="</div>"},i.prototype.renderMensagemOperador=function(t){var e=this.mensagemOperadorHTML(t);this.$elm.find(".alobot-chat-body").append(e),this.removerOperadorDigitandoFeedback()},i.prototype.removerMensagemTemporaria=function(t){var e=this.$elm.find(".alobot-chat-body"),o=e.find('.alobot-chat-mensagem[data-temporario="true"]');1==o.length?o.remove():o.each(function(){var e=AlobotJQuery(this),o=t.mensagem_original||t.mensagem,a=o.replace(/(\<br \/\>|&gt;|&lt;|[<>()\[\]])/g,"").trim(),i=e.find(".conteudo_mensagem").text().replace(/(\<br \/\>|&gt;|&lt;|[<>()\[\]])/g,"").trim();a==i&&e.remove()})},i.prototype.renderMensagemContato=function(t){if(this.removerMensagemTemporaria(t),2!=t.tipo||!this.atendimentoIniciadoNessaSessao){var e="",i="";t.id||(i+='data-temporario="true"'),e+='<div class="alobot-chat-mensagem alobot-chat-mensagem-usuario" '+i+">",e+='<div class="alobot-chat-mensagem-texto" style="margin-right: 5px;">',e+='<div class="alobot-chat-mensagem-balao">',e+='<div class="alobot-chat-dados-envio"><b>'+(t.nome_envio||a.t("você"))+"</b>&nbsp;"+o.horarioDaMensagem(t)+"</div>",e+='<span class="conteudo_mensagem">'+(t.mensagem_original||t.mensagem)+"</span>",t.url_arquivo&&(e+='<div style="overflow: auto;"><a href="'+t.url_arquivo+'" target="_blank"><i class="alobot-icon alobot-icon-file"></i>'+AlobotClient.extrairArquivoDaUrl(t.url_arquivo)+"</a></div>"),e+="</div>",e+="</div>","1"==this.opts.mostrarAvatarOperador&&(e+='<div class="alobot-chat-mensagem-avatar">',e+=t.id?'<img src="'+t.url_avatar+'" class="avatar" />':'<img src="'+AlobotClient.loadingGifUrl()+'" class="avatar" />',e+="</div>"),e+="</div>",this.removerOperadorDigitandoFeedback(),this.$elm.find(".alobot-chat-body").append(e)}},i.prototype.scrollChatBodyToBottom=function(){var t=this.$elm.find(".alobot-chat-body");t.length&&t.scrollTop(t[0].scrollHeight)},i.prototype.removerOperadorDigitandoFeedback=function(){this.operadorRespondendoTimeout&&clearTimeout(this.operadorRespondendoTimeout),this.$elm.find(".alobot-chat-body").find(".operador-digitando-feedback").remove()},i.prototype.desabilitarMensagemInput=function(){var t=this.$elm.find(".alobot-chat-input-container");t.find(".alobot-chat-input-disable").show()},i.prototype.habilitarMensagemInput=function(){var t=this.$elm.find(".alobot-chat-input-container");t.find(".alobot-chat-input-disable").hide()},i.prototype.atualizarLayoutParaFinalizado=function(){this.$elm.find(".alobot-chat-container").addClass("finalizado")},i.prototype.atualizarHeader=function(t){this.$elm.find(".alobot-chat-header-avatar").find("img").attr("src",t.avatar),this.$elm.find(".alobot-chat-header-nome").text(t.nome)},i.prototype.adicionarIndicadorLoadingAntesPrimeiraMensagem=function(){this.desabilitarMensagemInput();var t="megatron"==this.opts.layout?"#aaa":this.opts.cor,e='<div class="alobot_loading_feedback">';e+='<svg width="80px" height="80px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-comments"> <path d="M78,19H22c-6.6,0-12,5.4-12,12v31c0,6.6,5.4,12,12,12h37.2c0.4,3,1.8,5.6,3.7,7.6c2.4,2.5,5.1,4.1,9.1,4 c-1.4-2.1-2-7.2-2-10.3c0-0.4,0-0.8,0-1.3h8c6.6,0,12-5.4,12-12V31C90,24.4,84.6,19,78,19z" ng-attr-fill="{{config.c1}}" fill="'+t+'"></path> <circle cx="30" cy="47" r="5" ng-attr-fill="{{config.c2}}" fill="#ffffff"> <animate attributeName="opacity" calcMode="linear" values="0;1;1" keyTimes="0;0.2;1" dur="1" begin="0s" repeatCount="indefinite"></animate> </circle> <circle cx="50" cy="47" r="5" ng-attr-fill="{{config.c3}}" fill="#ffffff"> <animate attributeName="opacity" calcMode="linear" values="0;0;1;1" keyTimes="0;0.2;0.4;1" dur="1" begin="0s" repeatCount="indefinite"></animate> </circle> <circle cx="70" cy="47" r="5" ng-attr-fill="{{config.c4}}" fill="#ffffff"> <animate attributeName="opacity" calcMode="linear" values="0;0;1;1" keyTimes="0;0.4;0.6;1" dur="1" begin="0s" repeatCount="indefinite"></animate> </circle> </svg>',e+='<div class="alobot_loading_feedback_carregando">Carregando...</div>',e+="</div>",this.$elm.find(".alobot-chat-body").append(e)},i.prototype.removerIndicadorLoadingAntesPrimeiraMensagem=function(){this.habilitarMensagemInput(),this.$elm.find(".alobot_loading_feedback").remove()},i.prototype.removerOptionsCasoExista=function(){}}(window),AlobotClient.AutoFAQ=function(t){},function(){function t(t){for(var e=t.length,o=t.length-1;o>=0;o--){var a=t.charCodeAt(o);a>127&&a<=2047?e++:a>2047&&a<=65535&&(e+=2),a>=56320&&a<=57343&&o--}return e}var e=2e3,o="!@#",a=AlobotClient.Tracker=function(){this.url=document.location.href,this.timestamp=parseInt((new Date).getTime()/1e3),this.primeiroReferrer()||this.armazenarPrimeiroReferrer(),this.armazenarLocal();var t=this;AlobotClient.estaEmAtendimento(function(e){e&&t.enviarServidor()})};a.prototype.enviarServidor=function(){AlobotJQuery.post(AlobotClient.url+"/chat/atendimentos/"+AlobotClient.cache("id_atendimento")+"/visita",{url:this.url,timestamp:this.timestamp},function(){})},a.prototype.armazenarPrimeiroReferrer=function(){AlobotCookies.set("alobot_pr",document.referrer,{expires:1/0,sameSite:"None",secure:window.location.protocol.indexOf("https")!==-1})},a.prototype.removerVisitaMaisAntiga=function(t){var e=t.indexOf(o);return t.substr(e+o.length,t.length)},a.prototype.armazenarLocal=function(){var a=AlobotClient.cache("alobot_th");a||(a=""),a+=this.url+" "+this.timestamp+o,t(a)>e&&(a=this.removerVisitaMaisAntiga(a))},a.prototype.visitasJson=function(){for(var t=AlobotClient.cache("alobot_th")||"",e=t.split(o),a=[],i=0;i<e.length;i++){var n=e[i].split(" ");2==n.length&&a.push({url:n[0],timestamp:+n[1]})}return a},a.prototype.primeiroReferrer=function(){return AlobotCookies.get("alobot_pr")},window.addEventListener("load",function(){window.blockAlobotTracker||(AlobotClient.tracker=new a)})}(),function(){var t=AlobotClient.Resizer={};t.fixHeight=function(){if(AlobotClient.getConfig("width")&&(AlobotJQuery(".alobot-chat-body").length?AlobotJQuery(".alobot-container").css("width",AlobotClient.getConfig("width")):AlobotJQuery(".alobot-container").css("width","")),AlobotClient.getConfig("height")&&AlobotJQuery(".alobot-chat-content-container").css("height",AlobotClient.getConfig("height")),(!AlobotClient.config||AlobotClient.config.fullscreen||AlobotClient.config.mobile)&&!t.bloquear){var e,o,a=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,AlobotJQuery(".alobot-wrapper").height()||window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight),i=AlobotJQuery(".alobot-wrapper > .alobot-container").height(),n=a-i,r=AlobotJQuery(".alobot-chat-body,.alobot_aguardando_personalizacao,.alobot-chat-sucesso-mensagem-offline,.alobot-chat-content-container"),l=r[0];if(l){var s=getComputedStyle(l),c=parseFloat(s.paddingLeft)+parseFloat(s.paddingRight),d=parseFloat(s.paddingTop)+parseFloat(s.paddingBottom),m=parseFloat(s.borderLeftWidth)+parseFloat(s.borderRightWidth),u=parseFloat(s.borderTopWidth)+parseFloat(s.borderBottomWidth);o=l.offsetWidth-c-m,e=l.offsetHeight-d-u}if(AlobotClient.config&&AlobotClient.config.fullscreen&&e)var p=e;else var p=r.height();r.css("height",p+n+"px")}},window.addEventListener("resize",function(){t.fixHeight()})}(),function(){var t=AlobotClient.Alertas={},e=0,o=!0,a=null,i=null;t.emitirSonoro=function(){"IE"!=AlobotClient.navegadorAtual()&&window.Audio&&(t.alertaSonoro?(t.alertaSonoro.pause(),t.alertaSonoro.currentTime=0):t.alertaSonoro=new Audio([AlobotClient.url+"/sound/notify.mp3"]),t.alertaSonoro.play())},t.emitirSonoroEmLoop=function(){t.emitirSonoro(),i&&(clearInterval(i),i=null);i=setInterval(function(){t.emitirSonoro()},4e3)},t.emitirFavicon=function(){window.AlobotTinycon&&AlobotTinycon.setBubble(e)},t.incrementarFavicon=function(){e+=1,t.emitirFavicon()},t.emitirWebNotification=function(t){if(!window.Notification)return!1;if("granted"!=Notification.permission)return!1;a&&(a.close(),a=null);var e=AlobotClient.cache("alobot_header_avatar")||AlobotClient.opts.chat.headerAvatarUrl,o=new Notification("ALOWEB",{
icon:e,body:t});return o.onclick=function(){window.focus(),o.close(),a=null},a=o,!0},t.pedirPermissaoWebNotification=function(){window.Notification&&"granted"!=Notification.permission&&Notification.requestPermission()},t.emitir=function(a,i){if(i=i||{},e+=1,!o&&(t.emitirSonoroEmLoop(),t.emitirFavicon(),a)){t.emitirWebNotification(a)}},t.limpar=function(){e=0,i&&(clearInterval(i),i=null),t.alertaSonoro&&"IE"!=AlobotClient.navegadorAtual()&&(t.alertaSonoro.pause(),t.alertaSonoro.currentTime=0),t.emitirFavicon(),a&&a.close()},AlobotJQuery(window).on("focus",function(){o=!0,t.limpar()}),AlobotJQuery(window).on("blur",function(){o=!1})}();